import streamlit as st
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime
import warnings
warnings.filterwarnings('ignore')

# ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ
st.set_page_config(page_title="ูุฑุฏุฉ ุงูุนูุงุฑูุฉ", page_icon="๐", layout="wide")

# ุชุตููู ุนุฑุจู ุงุญุชุฑุงูู
st.markdown("""
<style>
    .main-title {
        font-size: 2.5rem;
        color: #1f77b4;
        text-align: center;
        margin-bottom: 1rem;
    }
    .sub-title {
        font-size: 1.2rem;
        color: #ff7f0e;
        text-align: center;
        margin-bottom: 2rem;
    }
    .section-header {
        background-color: #f0f2f6;
        padding: 1rem;
        border-radius: 0.5rem;
        margin: 1rem 0;
    }
</style>
""", unsafe_allow_html=True)

# ุงูุนููุงู ุงูุฑุฆูุณู
st.markdown('<div class="main-title">๐ก ูุฑุฏุฉ ุงูุนูุงุฑูุฉ - ุงูุชุญููู ุงูุนูุงุฑู ุงููุชูุฏู</div>', unsafe_allow_html=True)
st.markdown('<div class="sub-title">ููุตุฉ ุฐููุฉ ูุชุญููู ุงูุฃุณูุงู ุงูุนูุงุฑูุฉ ูุชูุฏูู ุชูุตูุงุช ุงุณุชุซูุงุฑูุฉ ุฏูููุฉ</div>', unsafe_allow_html=True)

st.markdown("---")

# ๐ฏ ุงููุณู 1: ุฅุฏุฎุงู ุงูุจูุงูุงุช ุงููุชูุฏู
st.markdown('<div class="section-header">๐ ุชุญุฏูุฏ ูุชุทูุจุงุช ุงูุชุญููู</div>', unsafe_allow_html=True)

col1, col2, col3 = st.columns(3)

with col1:
    st.subheader("๐๏ธ ุงููููุน")
    ุงููุฏููุฉ = st.selectbox("ุงููุฏููุฉ", ["ุงูุฑูุงุถ", "ุฌุฏุฉ", "ุงูุฏูุงู", "ููุฉ", "ุงููุฏููุฉ", "ุงูุฎุจุฑ", "ุงูุทุงุฆู"])
    ุงูุญู = st.text_input("ุงูุญู (ุงุฎุชูุงุฑู)", placeholder="ุฃุฏุฎู ุงุณู ุงูุญู")

with col2:
    st.subheader("๐ ููุน ุงูุนูุงุฑ")
    ููุน_ุงูุนูุงุฑ = st.selectbox("ููุน ุงูุนูุงุฑ", ["ุดูู", "ููู", "ุฃุฑุงุถู", "ููุงุชุจ", "ูุญูุงุช"])
    ุงููุณุงุญุฉ = st.slider("ุงููุณุงุญุฉ ุงููุทููุจุฉ (ูยฒ)", 50, 1000, 150)

with col3:
    st.subheader("๐ฐ ุงูููุฒุงููุฉ ูุงููุฏู")
    ุงูููุฒุงููุฉ = st.selectbox("ุงูููุฒุงููุฉ ุงููุชููุนุฉ", [
        "ุฃูู ูู 500,000 ุฑูุงู",
        "500,000 - 1,000,000 ุฑูุงู", 
        "1,000,000 - 2,000,000 ุฑูุงู",
        "2,000,000 - 5,000,000 ุฑูุงู",
        "ุฃูุซุฑ ูู 5,000,000 ุฑูุงู"
    ])
    
    ุงููุฏู = st.selectbox("ุงููุฏู ุงูุงุณุชุซูุงุฑู", [
        "ุงุณุชุซูุงุฑ ุทููู ุงููุฏู",
        "ุชุฏุงูู ุณุฑูุน", 
        "ุณูู ุดุฎุตู",
        "ุชุทููุฑ ุนูุงุฑู"
    ])

# ๐ฏ ุงููุณู 2: ุฎูุงุฑุงุช ูุชูุฏูุฉ
st.markdown('<div class="section-header">โ๏ธ ุฎูุงุฑุงุช ุงูุชุญููู ุงููุชูุฏู</div>', unsafe_allow_html=True)

col4, col5 = st.columns(2)

with col4:
    st.subheader("๐ ูุณุชูู ุงูุชูุตูู")
    ูุณุชูู_ุงูุชูุตูู = st.radio("ูุณุชูู ุงูุชูุฑูุฑ:", [
        "ุชูุฑูุฑ ุณุฑูุน (ุชุญููู ุฃุณุงุณู)",
        "ุชูุฑูุฑ ูุชูุฏู (ุชุญููู ููุตู)", 
        "ุฏุฑุงุณุฉ ุดุงููุฉ (ุชูุตูุงุช ุงุณุชุฑุงุชูุฌูุฉ)"
    ])

with col5:
    st.subheader("๐ฆ ุงูุจุงูุงุช")
    ุงูุจุงูุฉ = st.selectbox("ุงุฎุชุฑ ุงูุจุงูุฉ:", [
        "ุงูุจุงูุฉ ุงูุฃุณุงุณูุฉ - 100$ (ุชูุฑูุฑ ุชุญูููู)",
        "ุงูุจุงูุฉ ุงููุชูุฏูุฉ - 250$ (ุชูุฑูุฑ + ุชูุตูุงุช)", 
        "ุงูุจุงูุฉ ุงููููุฒุฉ - 500$ (ุฏุฑุงุณุฉ ุดุงููุฉ + ูุชุงุจุนุฉ)"
    ])

# ๐ฏ ุงููุณู 3: ุฒุฑ ุงูุชุดุบูู ุงูุฑุฆูุณู
st.markdown("---")
if st.button("๐ ุฅูุดุงุก ุงูุชูุฑูุฑ ุงููุชูุงูู", type="primary", use_container_width=True):
    
    with st.spinner("๐ ุฌุงุฑู ุชุญููู ุจูุงูุงุช ุงูุณูู ูุฅุนุฏุงุฏ ุงูุชูุฑูุฑ..."):
        
        # ูุญุงูุงุฉ ุจูุงูุงุช ูุงูุนูุฉ
        np.random.seed(42)
        
        # ุฅูุดุงุก ุจูุงูุงุช ูุชููุนุฉ ุจูุงุก ุนูู ุงูุงุฎุชูุงุฑุงุช
        data = []
        for i in range(100):
            # ุฃุณุนุงุฑ ูุงูุนูุฉ ุญุณุจ ุงููุฏููุฉ ูููุน ุงูุนูุงุฑ
            ุฃุณุนุงุฑ_ุฃุณุงุณูุฉ = {
                "ุงูุฑูุงุถ": {"ุดูู": (600000, 1500000), "ููู": (2000000, 5000000), "ุฃุฑุงุถู": (800000, 3000000)},
                "ุฌุฏุฉ": {"ุดูู": (500000, 1200000), "ููู": (1500000, 4000000), "ุฃุฑุงุถู": (600000, 2500000)},
                "ุงูุฏูุงู": {"ุดูู": (400000, 1000000), "ููู": (1200000, 3000000), "ุฃุฑุงุถู": (500000, 2000000)}
            }
            
            ุณุนุฑ_ูุฏู = ุฃุณุนุงุฑ_ุฃุณุงุณูุฉ.get(ุงููุฏููุฉ, ุฃุณุนุงุฑ_ุฃุณุงุณูุฉ["ุงูุฑูุงุถ"]).get(ููุน_ุงูุนูุงุฑ, (500000, 2000000))
            ุณุนุฑ = np.random.randint(ุณุนุฑ_ูุฏู[0], ุณุนุฑ_ูุฏู[1])
            ูุณุงุญุฉ = np.random.randint(80, 400)
            
            data.append({
                "ุงูุนูุงุฑ": f"{ููุน_ุงูุนูุงุฑ[:-1]} {i+1}",
                "ุงููุฏููุฉ": ุงููุฏููุฉ,
                "ุงูุญู": np.random.choice(["ุงููุฎูู", "ุงูุฑูุถุฉ", "ุงูุตูุง", "ุงูุฒูุฑุงุก", "ุงูุฑุจูุฉ", "ุงูููุฒ", "ุงูุนููุง"]),
                "ููุน_ุงูุนูุงุฑ": ููุน_ุงูุนูุงุฑ[:-1],
                "ุงูุณุนุฑ": ุณุนุฑ,
                "ุงููุณุงุญุฉ": ูุณุงุญุฉ,
                "ุณุนุฑ_ุงููุชุฑ": int(sุนุฑ / ูุณุงุญุฉ),
                "ุงูุนุงุฆุฏ_ุงููุชููุน": np.random.uniform(5, 15),
                "ูุณุชูู_ุงูุฎุทูุฑุฉ": np.random.choice(["ููุฎูุถ", "ูุชูุณุท", "ูุฑุชูุน"])
            })
        
        df = pd.DataFrame(data)
        
        # โ ุนุฑุถ ุงููุชุงุฆุฌ
        st.success(f"โ ุชู ุชุญููู {len(df)} ุนูุงุฑ ูู ุงูุณูู ุจูุฌุงุญ!")
        
        # ๐ ุงููุณู 4: ุงููุชุงุฆุฌ ุงููุชูุฏูุฉ
        st.markdown("---")
        st.markdown('<div class="section-header">๐ ูุชุงุฆุฌ ุงูุชุญููู ุงููุชูุงูู</div>', unsafe_allow_html=True)
        
        # ุงูุฅุญุตุงุฆูุงุช ูู ุฃุนูุฏุฉ
        col6, col7, col8, col9 = st.columns(4)
        
        with col6:
            st.metric("๐ฐ ูุชูุณุท ุงูุณุนุฑ", f"{df['ุงูุณุนุฑ'].mean():,.0f} ุฑูุงู")
        with col7:
            st.metric("๐ ูุชูุณุท ุงููุณุงุญุฉ", f"{df['ุงููุณุงุญุฉ'].mean():.0f} ูยฒ")
        with col8:
            st.metric("๐ ุณุนุฑ ุงููุชุฑ", f"{df['ุณุนุฑ_ุงููุชุฑ'].mean():,.0f} ุฑูุงู")
        with col9:
            st.metric("๐ ูุชูุณุท ุงูุนุงุฆุฏ", f"{df['ุงูุนุงุฆุฏ_ุงููุชููุน'].mean():.1f}%")
        
        # ๐ ุงููุณู 5: ุงูุฑุณูู ุงูุจูุงููุฉ
        st.subheader("๐ ุงูุชุญูููุงุช ุงูุจุตุฑูุฉ ุงููุชูุฏูุฉ")
        
        fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 10))
        
        # 1. ุชูุฒูุน ุงูุฃุณุนุงุฑ
        ax1.hist(df['ุงูุณุนุฑ'], bins=20, alpha=0.7, color='skyblue', edgecolor='black')
        ax1.set_xlabel('ุงูุณุนุฑ (ุฑูุงู)')
        ax1.set_ylabel('ุนุฏุฏ ุงูุนูุงุฑุงุช')
        ax1.set_title('ุชูุฒูุน ุงูุฃุณุนุงุฑ ูู ุงูุณูู')
        ax1.ticklabel_format(style='plain', axis='x')
        
        # 2. ุงูุนูุงูุฉ ุจูู ุงููุณุงุญุฉ ูุงูุณุนุฑ
        ax2.scatter(df['ุงููุณุงุญุฉ'], df['ุงูุณุนุฑ'], alpha=0.6, color='coral')
        ax2.set_xlabel('ุงููุณุงุญุฉ (ูยฒ)')
        ax2.set_ylabel('ุงูุณุนุฑ (ุฑูุงู)')
        ax2.set_title('ุงูุนูุงูุฉ ุจูู ุงููุณุงุญุฉ ูุงูุณุนุฑ')
        
        # 3. ุฃูุถู ุงูุฃุญูุงุก
        ุญู_ุฃุณุนุงุฑ = df.groupby('ุงูุญู')['ุณุนุฑ_ุงููุชุฑ'].mean().sort_values()
        ax3.barh(range(len(ุญู_ุฃุณุนุงุฑ)), ุญู_ุฃุณุนุงุฑ.values, color='lightgreen')
        ax3.set_yticks(range(len(ุญู_ุฃุณุนุงุฑ)))
        ax3.set_yticklabels(ุญู_ุฃุณุนุงุฑ.index)
        ax3.set_xlabel('ูุชูุณุท ุณุนุฑ ุงููุชุฑ (ุฑูุงู)')
        ax3.set_title('ุฃูุถู ุงูุฃุญูุงุก ูู ุญูุซ ุงูุณุนุฑ')
        
        # 4. ุชูุฒูุน ุงูุนูุงุฆุฏ
        ax4.hist(df['ุงูุนุงุฆุฏ_ุงููุชููุน'], bins=15, alpha=0.7, color='gold', edgecolor='black')
        ax4.set_xlabel('ุงูุนุงุฆุฏ ุงููุชููุน (%)')
        ax4.set_ylabel('ุนุฏุฏ ุงูุนูุงุฑุงุช')
        ax4.set_title('ุชูุฒูุน ุงูุนูุงุฆุฏ ุงููุชููุนุฉ')
        
        plt.tight_layout()
        st.pyplot(fig)
        
        # ๐ ุงููุณู 6: ุฃูุถู ุงูุนุฑูุถ
        st.subheader("๐ ุฃูุถู ุงูุนุฑูุถ ุงูุงุณุชุซูุงุฑูุฉ")
        
        ุฃูุถู_ุนุฑูุถ = df.nsmallest(10, 'ุณุนุฑ_ุงููุชุฑ')
        st.dataframe(ุฃูุถู_ุนุฑูุถ[[
            'ุงูุนูุงุฑ', 'ุงูุญู', 'ุงูุณุนุฑ', 'ุงููุณุงุญุฉ', 'ุณุนุฑ_ุงููุชุฑ', 'ุงูุนุงุฆุฏ_ุงููุชููุน', 'ูุณุชูู_ุงูุฎุทูุฑุฉ'
        ]].style.format({
            'ุงูุณุนุฑ': '{:,}',
            'ุณุนุฑ_ุงููุชุฑ': '{:,}',
            'ุงูุนุงุฆุฏ_ุงููุชููุน': '{:.1f}%'
        }))
        
        # ๐ก ุงููุณู 7: ุงูุชูุตูุงุช ุงูุฐููุฉ
        st.markdown("---")
        st.markdown('<div class="section-header">๐ก ุงูุชูุตูุงุช ุงูุงุณุชุซูุงุฑูุฉ ุงูุฐููุฉ</div>', unsafe_allow_html=True)
        
        col10, col11 = st.columns(2)
        
        with col10:
            st.success(f"""
            **๐ฏ ุชูุตูุงุช ูุจููุฉ ุนูู ูุฏูู:**
            
            **ุงููุฏู:** {ุงููุฏู}
            **ุงููุฏููุฉ:** {ุงููุฏููุฉ}
            **ููุน ุงูุนูุงุฑ:** {ููุน_ุงูุนูุงุฑ}
            
            **ุงูุชูุตูุงุช:**
            โข ุฃูุถู ุญู ููุงุณุชุซูุงุฑ: **{ุญู_ุฃุณุนุงุฑ.index[0]}**
            โข ูุชูุณุท ุณุนุฑ ุงููุชุฑ: **{ุญู_ุฃุณุนุงุฑ.iloc[0]:,.0f} ุฑูุงู**
            โข ูุฑุตุฉ ุงูุชูููุฑ: **{(ุญู_ุฃุณุนุงุฑ.iloc[-1] - ุญู_ุฃุณุนุงุฑ.iloc[0]):,.0f} ุฑูุงู/ูยฒ**
            โข ุนุฏุฏ ุงููุฑุต ุงูููุชุงุฒุฉ: **{len(ุฃูุถู_ุนุฑูุถ)} ุนูุงุฑ**
            """)
        
        with col11:
            st.info(f"""
            **๐ ุฎุทุฉ ุงุณุชุซูุงุฑูุฉ ููุชุฑุญุฉ:**
            
            **1. ุงููุฑุญูุฉ ุงูุฃููู:**
            - ุงูุงุณุชุซูุงุฑ ูู {ุฃูุถู_ุนุฑูุถ.iloc[0]['ุงูุญู']}
            - ููุฒุงููุฉ: {ุฃูุถู_ุนุฑูุถ.iloc[0]['ุงูุณุนุฑ']:,} ุฑูุงู
            - ุนุงุฆุฏ ูุชููุน: {ุฃูุถู_ุนุฑูุถ.iloc[0]['ุงูุนุงุฆุฏ_ุงููุชููุน']:.1f}%
            
            **2. ุงููุฑุญูุฉ ุงูุซุงููุฉ:**
            - ุงูุชูููุน ูู {ุฃูุถู_ุนุฑูุถ.iloc[1]['ุงูุญู']}
            - ุชุญุณูู ุงููุญูุธุฉ ุงูุงุณุชุซูุงุฑูุฉ
            
            **3. ุงููุฑุงูุจุฉ:**
            - ูุชุงุจุนุฉ ุงุชุฌุงูุงุช ุงูุณูู
            - ุชุนุฏูู ุงูุงุณุชุฑุงุชูุฌูุฉ ุญุณุจ ุงููุชุบูุฑุงุช
            """)
        
        # ๐ณ ุงููุณู 8: ูุธุงู ุงูุฏูุน
        st.markdown("---")
        st.markdown('<div class="section-header">๐ณ ุงูุชูุงู ุงูุทูุจ ูุงูุฏูุน</div>', unsafe_allow_html=True)
        
        st.warning(f"""
        **ููุงุณุชูุงุฏุฉ ุงููุงููุฉ ูู ุงูุฎุฏูุฉ:**
        
        **ุงูุจุงูุฉ ุงููุฎุชุงุฑุฉ:** {ุงูุจุงูุฉ}
        **ูุดูู:**
        - ๐ ุชูุฑูุฑ PDF ููุตู
        - ๐ ุงุณุชุดุงุฑุฉ ุดุฎุตูุฉ ููุฏุฉ 30 ุฏูููุฉ
        - ๐ ูุชุงุจุนุฉ ุฃุณุจูุนูุฉ
        - ๐ ุชูุตูุงุช ุญุตุฑูุฉ
        - ๐ฑ ุชุญุฏูุซุงุช ูุณุชูุฑุฉ
        """)
        
        # ูุนูููุงุช ุงูุฏูุน
        st.info("""
        **ุทุฑููุฉ ุงูุฏูุน:**
        1. ุชุญููู ุจููู
        2. PayPal
        3. STC Pay
        
        **ุจุนุฏ ุงูุฏูุน:** ุณุชุชููู ุงูุชูุฑูุฑ ุงููุงูู ุฎูุงู 24 ุณุงุนุฉ
        """)

# ๐ ุงููุณู 9: ูุนูููุงุช ุงูุงุชุตุงู
st.markdown("---")
st.markdown('<div class="section-header">๐ ููุชูุงุตู ูุน ูุฑุฏุฉ ุงูุนูุงุฑูุฉ</div>', unsafe_allow_html=True)

col12, col13, col14 = st.columns(3)

with col12:
    st.write("**๐ ุงูุนููุงู:**")
    st.write("ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ")

with col13:
    st.write("**๐ง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:**")
    st.write("info@warda-realestate.com")

with col14:
    st.write("**โฐ ุณุงุนุงุช ุงูุนูู:**")
    st.write("9:00 ุตุจุงุญุงู - 5:00 ูุณุงุกู")

st.markdown("---")
st.markdown("โจ **ูุฑุฏุฉ ุงูุนูุงุฑูุฉ 2024** - ููุตุฉ ุงูุชุญููู ุงูุนูุงุฑู ุงูุฐูู")
