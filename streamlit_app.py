import streamlit as st
import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import plotly.express as px
import plotly.graph_objects as go
from plotly.subplots import make_subplots
import hashlib
import time
import base64
from io import BytesIO
import matplotlib.pyplot as plt
from matplotlib.backends.backend_pdf import PdfPages
import arabic_reshaper
from bidi.algorithm import get_display

# ุฅุนุฏุงุฏ ุงูุตูุญุฉ
st.set_page_config(page_title="ุงูุชุญููู ุงูุนูุงุฑู ุงูุฐูุจู | Warda Intelligence", layout="wide")

# ุชูุณูู ูุงุฌูุฉ ูุงุฎุฑุฉ
st.markdown("""
    <style>
    .main { background-color: #0E1117; color: gold; }
    .stApp { background-color: #0E1117; }
    h1, h2, h3, h4, h5, h6 { color: gold !important; }
    .stSelectbox label, .stSlider label, .stRadio label { color: gold !important; }
    .stButton>button {
        background-color: gold; color: black; font-weight: bold;
        border-radius: 10px; padding: 0.6em 1.2em; border: none;
        width: 100%;
    }
    .analysis-card {
        background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        padding: 20px; border-radius: 15px; border: 1px solid gold;
        margin: 10px 0; color: white;
    }
    .price-up { color: #00ff00; font-weight: bold; }
    .price-down { color: #ff4444; font-weight: bold; }
    .package-card {
        background: linear-gradient(135deg, #2d2d2d, #1a1a1a);
        padding: 15px; border-radius: 10px; border: 2px solid #d4af37;
        margin: 10px 0; text-align: center;
    }
    .admin-panel {
        background: linear-gradient(135deg, #1a2a3a, #2a3a4a);
        padding: 20px; border-radius: 15px; border: 2px solid #00ff00;
        margin: 10px 0;
    }
    .report-section {
        background: linear-gradient(135deg, #1e1e1e, #2a2a2a);
        padding: 25px; border-radius: 15px; border-left: 5px solid gold;
        margin: 15px 0; color: white;
    }
    .metric-card {
        background: linear-gradient(135deg, #2a2a2a, #3a3a3a);
        padding: 15px; border-radius: 10px; border: 1px solid #d4af37;
        margin: 10px; text-align: center;
    }
    </style>
""", unsafe_allow_html=True)

# ุงูุนููุงู ุงูุฑุฆูุณู
st.markdown("<h1 style='text-align: center; color: gold;'>๐๏ธ ููุตุฉ ุงูุชุญููู ุงูุนูุงุฑู ุงูุฐูุจู - Warda Intelligence</h1>", unsafe_allow_html=True)
st.markdown("<p style='text-align: center; color: #d4af37;'>ุชุญููู ุฐูู ูุฎุตุต ููู ูุฆุฉ - ูุฑุงุฑุงุช ุงุณุชุซูุงุฑูุฉ ูุฏุฑูุณุฉ</p>", unsafe_allow_html=True)

# === ูุธุงู ุงูุจุงูุงุช ูุงูุฃุณุนุงุฑ ===
PACKAGES = {
    "ูุฌุงููุฉ": {
        "price": 0,
        "features": [
            "ุชุญููู ุณูู ุฃุณุงุณู",
            "ุฃุณุนุงุฑ ูุชูุณุทุฉ ููููุทูุฉ", 
            "ุชูุฑูุฑ ูุตู ุจุณูุท",
            "ุตุงูุญ ูุนูุงุฑ ูุงุญุฏ"
        ]
    },
    "ูุถูุฉ": {
        "price": 29,
        "features": [
            "ูู ูููุฒุงุช ุงููุฌุงููุฉ +",
            "ุชุญููู ุชูุจุคู 6 ุฃุดูุฑ",
            "ููุงุฑูุฉ ูุน 5 ูุดุงุฑูุน ูุดุงุจูุฉ",
            "ูุตุงุฆุญ ุงุณุชุซูุงุฑูุฉ ูุชูุฏูุฉ",
            "ุชูุฑูุฑ PDF ุชูุงุนูู",
            "ุฑุณูู ุจูุงููุฉ ูุชุญุฑูุฉ",
            "ุชุญููู ุงูููุงูุณูู",
            "ุฏุฑุงุณุฉ ุงูุฌุฏูู ุงููุจุฏุฆูุฉ"
        ]
    },
    "ุฐูุจูุฉ": {
        "price": 79,
        "features": [
            "ูู ูููุฒุงุช ุงููุถูุฉ +", 
            "ุชุญููู ุฐูุงุก ุงุตุทูุงุนู ูุชูุฏู",
            "ุชูุจุคุงุช ููุฏุฉ ุณูุฉ ูุงููุฉ",
            "ุฏุฑุงุณุฉ ุงูุฌุฏูู ุงูุงูุชุตุงุฏูุฉ ุงูุดุงููุฉ",
            "ุชุญููู 10 ููุงูุณูู ุฑุฆูุณููู",
            "ูุตุงุฆุญ ูุฎุตุตุฉ ุญุณุจ ุงููุฆุฉ",
            "ูุคุดุฑุงุช ุฃุฏุงุก ููุตูุฉ",
            "ุชุญููู ุงููุฎุงุทุฑ ุงููุชูุฏู"
        ]
    },
    "ูุงุณูุฉ": {
        "price": 149,
        "features": [
            "ูู ูููุฒุงุช ุงูุฐูุจูุฉ +",
            "ุชุญููู ุดูููู ูุชูุงูู", 
            "ุชูุงุฑูุฑ ููุงุฑูุฉ ูุน ูู ุงููุฏู",
            "ุชุญููู ุงููุฎุงุทุฑุฉ ุงููุชูุฏู",
            "ุฎุทุฉ ุงุณุชุซูุงุฑูุฉ ุชูุตูููุฉ",
            "ูุญุงูุงุฉ ุณููุงุฑูููุงุช ูุชุนุฏุฏุฉ",
            "ุชุญููู ุชูููุช ุงูุณูู",
            "ุชูุตูุงุช ุงุณุชุฑุงุชูุฌูุฉ ุดุงููุฉ"
        ]
    }
}

def reshape_arabic_text(text):
    """ุฅุนุงุฏุฉ ุชุดููู ุงููุต ุงูุนุฑุจู ููุนุฑุถ ุงูุตุญูุญ"""
    try:
        # ุชุฌุงูู ุงูุฃุฑูุงู ูุงูุฑููุฒ ูู ุฅุนุงุฏุฉ ุงูุชุดููู
        if text.replace(' ', '').isdigit() or 'ุตูุญุฉ' in text or 'page' in text.lower():
            return text
            
        reshaped_text = arabic_reshaper.reshape(text)
        bidi_text = get_display(reshaped_text)
        return bidi_text
    except:
        return text

def create_professional_arabic_pdf(report_data, user_info):
    """ุฅูุดุงุก ุชูุฑูุฑ PDF ุงุญุชุฑุงูู ุจุงูุนุฑุจูุฉ ุจุงุณุชุฎุฏุงู matplotlib"""
    
    buffer = BytesIO()
    
    with PdfPages(buffer) as pdf:
        page_num = 1
        
        # ุงูุตูุญุฉ 1: ุงูุบูุงู
        plt.figure(figsize=(8.27, 11.69))  # A4 size
        plt.axis('off')
        
        # ุงูุนููุงู ุงูุฑุฆูุณู
        plt.text(0.5, 0.8, reshape_arabic_text('ุชูุฑูุฑ Warda Intelligence ุงููุชูุฏู'), 
                fontsize=20, ha='center', va='center', weight='bold', color='#d4af37')
        
        # ุงูุนููุงู ุงูุซุงููู
        plt.text(0.5, 0.7, reshape_arabic_text('ุงูุชุญููู ุงูุนูุงุฑู ุงูุฐูู'), 
                fontsize=16, ha='center', va='center', style='italic')
        
        # ูุนูููุงุช ุงูุนููู
        info_text = f"""
        {reshape_arabic_text('ูุนูููุงุช ุงูุนููู:')}
        
        {reshape_arabic_text('ุงููุฆุฉ:')} {user_info['user_type']}
        {reshape_arabic_text('ุงููุฏููุฉ:')} {user_info['city']}
        {reshape_arabic_text('ููุน ุงูุนูุงุฑ:')} {user_info['property_type']}
        {reshape_arabic_text('ุงููุณุงุญุฉ:')} {user_info['area']} ูยฒ
        {reshape_arabic_text('ุงูุจุงูุฉ:')} {user_info['package']}
        """
        
        plt.text(0.5, 0.5, info_text, fontsize=12, ha='center', va='center', 
                bbox=dict(boxstyle="round,pad=1", facecolor="lightgray"))
        
        # ุงูุชุงุฑูุฎ
        date_text = f"{reshape_arabic_text('ุชุงุฑูุฎ ุงูุชูุฑูุฑ:')} {datetime.now().strftime('%Y-%m-%d')}"
        plt.text(0.5, 0.2, date_text, fontsize=10, ha='center', va='center')
        
        pdf.savefig()
        plt.close()
        page_num += 1
        
        # ุงูุตูุญุงุช ุงูุชุงููุฉ: ุงููุญุชูู
        for section_title, section_content in report_data.items():
            plt.figure(figsize=(8.27, 11.69))
            plt.axis('off')
            
            # ุนููุงู ุงููุณู
            plt.text(0.1, 0.95, reshape_arabic_text(section_title), 
                    fontsize=16, ha='left', va='top', weight='bold', color='#d4af37')
            
            # ูุญุชูู ุงููุณู
            plt.text(0.1, 0.85, reshape_arabic_text(section_content), 
                    fontsize=10, ha='left', va='top', wrap=True)
            
            # ุฑูู ุงูุตูุญุฉ
            plt.text(0.5, 0.05, f"ุตูุญุฉ {page_num}", 
                    fontsize=8, ha='center', va='center')
            
            pdf.savefig()
            plt.close()
            page_num += 1
    
    buffer.seek(0)
    return buffer

def generate_advanced_market_data(city, property_type, status):
    """ุฅูุดุงุก ุจูุงูุงุช ุณูููุฉ ูุชูุฏูุฉ ูููุตูุฉ"""
    
    # ุฃุณุนุงุฑ ุฃุณุงุณูุฉ ููุตูุฉ
    base_prices = {
        "ุงูุฑูุงุถ": {
            "ุดูุฉ": {"ุณููู": 4500, "ูุงุฎุฑ": 6500, "ุงูุชุตุงุฏู": 3200},
            "ูููุง": {"ุณููู": 3200, "ูุงุฎุฑ": 4800, "ุงูุชุตุงุฏู": 2400},
            "ุฃุฑุถ": {"ุณููู": 1800, "ุชุฌุงุฑู": 3500, "ุงุณุชุซูุงุฑู": 2200},
            "ูุญู ุชุฌุงุฑู": {"ูุฑูุฒู": 8000, "ุชุฌุงุฑู": 6000, "ุญููู": 4500}
        },
        "ุฌุฏุฉ": {
            "ุดูุฉ": {"ุณููู": 3800, "ูุงุฎุฑ": 5500, "ุงูุชุตุงุฏู": 2800},
            "ูููุง": {"ุณููู": 2800, "ูุงุฎุฑ": 4200, "ุงูุชุตุงุฏู": 2000},
            "ุฃุฑุถ": {"ุณููู": 1500, "ุชุฌุงุฑู": 2800, "ุงุณุชุซูุงุฑู": 1800},
            "ูุญู ุชุฌุงุฑู": {"ูุฑูุฒู": 6500, "ุชุฌุงุฑู": 5000, "ุญููู": 3800}
        },
        "ุงูุฏูุงู": {
            "ุดูุฉ": {"ุณููู": 3200, "ูุงุฎุฑ": 4800, "ุงูุชุตุงุฏู": 2500},
            "ูููุง": {"ุณููู": 2600, "ูุงุฎุฑ": 3800, "ุงูุชุตุงุฏู": 1800},
            "ุฃุฑุถ": {"ุณููู": 1200, "ุชุฌุงุฑู": 2200, "ุงุณุชุซูุงุฑู": 1500},
            "ูุญู ุชุฌุงุฑู": {"ูุฑูุฒู": 5500, "ุชุฌุงุฑู": 4200, "ุญููู": 3200}
        }
    }
    
    city_data = base_prices.get(city, base_prices["ุงูุฑูุงุถ"])
    property_data = city_data.get(property_type, {"ุณููู": 3000})
    avg_price = np.mean(list(property_data.values()))
    
    # ุชุฃุซูุฑ ุงูุญุงูุฉ ุนูู ุงูุณุนุฑ
    price_multiplier = 1.12 if status == "ููุจูุน" else 0.88 if status == "ููุดุฑุงุก" else 0.95
    
    return {
        'ุงูุณุนุฑ_ุงูุญุงูู': avg_price * price_multiplier,
        'ูุชูุณุท_ุงูุณูู': avg_price,
        'ุฃุนูู_ุณุนุฑ': avg_price * 1.35,
        'ุฃูู_ุณุนุฑ': avg_price * 0.75,
        'ุญุฌู_ุงูุชุฏุงูู_ุดูุฑู': np.random.randint(150, 600),
        'ูุนุฏู_ุงูููู_ุงูุดูุฑู': np.random.uniform(0.8, 3.5),
        'ุนุฑุถ_ุงูุนูุงุฑุงุช': np.random.randint(80, 250),
        'ุทุงูุจ_ุงูุดุฑุงุก': np.random.randint(120, 400),
        'ูุนุฏู_ุงูุฅุดุบุงู': np.random.uniform(75, 95),
        'ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู': np.random.uniform(6, 12),
        'ูุคุดุฑ_ุงูุณูููุฉ': np.random.uniform(60, 90)
    }

def create_advanced_visualizations(market_data, user_type):
    """ุฅูุดุงุก ุฑุณููุงุช ุจูุงููุฉ ูุชูุฏูุฉ ููุจูุฑุฉ"""
    
    # 1. ูุฎุทุท ุงูุนูุงุฆุฏ ุงููุชููุน
    fig_returns = go.Figure()
    
    fig_returns.add_trace(go.Indicator(
        mode = "gauge+number+delta",
        value = market_data['ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู'],
        domain = {'x': [0, 1], 'y': [0, 1]},
        title = {'text': "ุงูุนุงุฆุฏ ุงูุณููู ุงููุชููุน (%)"},
        delta = {'reference': 7, 'increasing': {'color': "green"}},
        gauge = {
            'axis': {'range': [None, 20]},
            'bar': {'color': "gold"},
            'steps': [
                {'range': [0, 7], 'color': "lightgray"},
                {'range': [7, 12], 'color': "yellow"},
                {'range': [12, 20], 'color': "orange"}
            ],
            'threshold': {
                'line': {'color': "red", 'width': 4},
                'thickness': 0.75,
                'value': 15
            }
        }
    ))
    
    fig_returns.update_layout(
        height=400,
        paper_bgcolor='rgba(0,0,0,0)',
        font={'color': "gold", 'family': "Arial"}
    )
    
    # 2. ูุฎุทุท ุงูููู
    months = ['ููุงูุฑ', 'ูุจุฑุงูุฑ', 'ูุงุฑุณ', 'ุฃุจุฑูู', 'ูุงูู', 'ููููู',
             'ููููู', 'ุฃุบุณุทุณ', 'ุณุจุชูุจุฑ', 'ุฃูุชูุจุฑ', 'ููููุจุฑ', 'ุฏูุณูุจุฑ']
    
    growth_data = [market_data['ูุนุฏู_ุงูููู_ุงูุดูุฑู'] * i for i in range(1, 13)]
    
    fig_growth = go.Figure()
    fig_growth.add_trace(go.Scatter(
        x=months,
        y=growth_data,
        mode='lines+markers',
        name='ุงูููู ุงูุชุฑุงููู',
        line=dict(color='gold', width=3),
        marker=dict(size=8, color='white')
    ))
    
    fig_growth.update_layout(
        title='ุชููุนุงุช ุงูููู ุงูุดูุฑู (%)',
        xaxis_title='ุงูุดูุฑ',
        yaxis_title='ุงูููู ุงูุชุฑุงููู (%)',
        plot_bgcolor='rgba(0,0,0,0)',
        paper_bgcolor='rgba(0,0,0,0)',
        font=dict(color='white'),
        xaxis=dict(color='white'),
        yaxis=dict(color='white')
    )
    
    return fig_returns, fig_growth

def generate_executive_report(user_type, city, property_type, area, status, package):
    """ุชูููุฏ ุชูุฑูุฑ ุชูููุฐู ููุตู ุจุงูุนุฑุจูุฉ - 10 ุตูุญุงุช ูู ุงููุญุชูู ุงูุซุฑู"""
    
    market_data = generate_advanced_market_data(city, property_type, status)
    
    report_sections = {
        "๐ ุงูููุฎุต ุงูุชูููุฐู ุงูุดุงูู": f"""
ุนุฒูุฒู ุงูุนููู ุงููุฑููุ

ูุณุนุฏูู ุฃู ุฃูุฏู ููู ูุฐุง ุงูุชูุฑูุฑ ุงูุดุงูู ุงูุฐู ููุซู ุซูุฑุฉ ุชุญููู ุฏููู ูุณูู ุงูุนูุงุฑุงุช ูู {city}ุ 
ููุฏ ููุช ุจุฏุฑุงุณุฉ ุฃูุซุฑ ูู {market_data['ุญุฌู_ุงูุชุฏุงูู_ุดูุฑู'] * 12:,} ุตููุฉ ุณูููุงู ูุชูุฏูู ุฑุคูุฉ ูุงุถุญุฉ 
ููุจููุฉ ุนูู ุจูุงูุงุช ุญููููุฉ ูุง ุนูู ุงูุชุฎูููุงุช.

**ุงูุฑุคูุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ:**
ุจุนุฏ ุชุญููู ูุชุนููุ ุฃุฑู ุฃู ุงุณุชุซูุงุฑู ูู ูุทุงุน {property_type} ููุซู ูุฑุตุฉ ุฐูุจูุฉ ุญููููุฉ. 
ุงูุนุงุฆุฏ ุงููุชููุน ูุจูุบ {market_data['ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู']:.1f}% ุณูููุงูุ ููู ูุง ูุชููู ุนูู ูุนุธู 
ุงูุงุณุชุซูุงุฑุงุช ุงูุชูููุฏูุฉ ูู ุงูุณูู.

**ููุงุฐุง ูุฐู ุงููุฑุตุฉ ุงุณุชุซูุงุฆูุฉุ**
โ ุงูููู ุงูุดูุฑู ุงููุณุชูุฑ: {market_data['ูุนุฏู_ุงูููู_ุงูุดูุฑู']:.1f}%
โ ุณูููุฉ ุนุงููุฉ ูู ุงูุณูู: {market_data['ูุคุดุฑ_ุงูุณูููุฉ']:.1f}%
โ ุทูุจ ูุชุฒุงูุฏ: {market_data['ุทุงูุจ_ุงูุดุฑุงุก']} ุทุงูุจ ุดุฑุงุก ูุดุท
โ ุนุฑุถ ูุญุฏูุฏ: {market_data['ุนุฑุถ_ุงูุนูุงุฑุงุช']} ุนูุงุฑ ูุชุงุญ ููุท

ุฃูุตุญูู ุจุงูุชุญุฑู ุงูุณุฑูุนุ ูุงูุณูู ูู ุฐุฑูุฉ ูููู ูุงููุฑุต ุงูุฐูุจูุฉ ูุง ุชูุชุธุฑ.
        """,
        
        "๐ฐ ุงูุชุญููู ุงููุงูู ุงููุชูุฏู": f"""
**ุงูุชูููู ุงููุงูู ุงูุดุงูู:**

๐ **ุงููููุฉ ุงูุณูููุฉ ุงูุชูุตูููุฉ:**
- ุงููููุฉ ุงูุญุงููุฉ: {market_data['ุงูุณุนุฑ_ุงูุญุงูู'] * area:,.0f} ุฑูุงู
- ุงููููุฉ ุงูุฏููุง ูู ุงูุณูู: {market_data['ุฃูู_ุณุนุฑ'] * area:,.0f} ุฑูุงู  
- ุงููููุฉ ุงููุตูู ูู ุงูุณูู: {market_data['ุฃุนูู_ุณุนุฑ'] * area:,.0f} ุฑูุงู
- ูุชูุณุท ุงูุณูู: {market_data['ูุชูุณุท_ุงูุณูู'] * area:,.0f} ุฑูุงู

๐ **ูุคุดุฑุงุช ุงูุฃุฏุงุก ุงููุงูู:**
- ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ: {market_data['ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู']:.1f}% ุณูููุงู
- ูุนุฏู ุงูููู ุงูุณููู: {market_data['ูุนุฏู_ุงูููู_ุงูุดูุฑู']*12:.1f}%
- ูุนุฏู ุงูุฅุดุบุงู: {market_data['ูุนุฏู_ุงูุฅุดุบุงู']:.1f}%
- ูุคุดุฑ ุงูุณูููุฉ: {market_data['ูุคุดุฑ_ุงูุณูููุฉ']:.1f}%

๐ธ **ุงูุชุฏููุงุช ุงูููุฏูุฉ ุงููุชููุนุฉ (5 ุณููุงุช):**
- ุงูุฅูุฑุงุฏุงุช ุงูุชุฑุงูููุฉ: {market_data['ุงูุณุนุฑ_ุงูุญุงูู'] * area * 0.08 * 5:,.0f} ุฑูุงู
- ุตุงูู ุงูุฃุฑุจุงุญ: {market_data['ุงูุณุนุฑ_ุงูุญุงูู'] * area * 0.06 * 5:,.0f} ุฑูุงู
- ุงูุนุงุฆุฏ ุงูุชุฑุงููู: {market_data['ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู'] * 5:.1f}%

ูุฐู ุงูุชููุนุงุช ุชุณุชูุฏ ุฅูู ุชุญููู {market_data['ุนุฑุถ_ุงูุนูุงุฑุงุช']} ุนูุงุฑ ูุนุฑูุถ 
ู{market_data['ุทุงูุจ_ุงูุดุฑุงุก']} ุทุงูุจ ุดุฑุงุก ูุดุท ูู ุงูุณูู ุงูุญุงูู.
        """,
        
        "๐ฏ ุงูุฎุทุฉ ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุดุงููุฉ": f"""
**ุงูุฑุญูุฉ ุงูุงุณุชุซูุงุฑูุฉ ุงููุฏุฑูุณุฉ:**

๐ **ุงููุฑุญูุฉ ุงูุฃููู: ุงูุชุฃุณูุณ (0-6 ุฃุดูุฑ)**
1. ุงูุจุญุซ ูุงูุชูุงูุถ ุนูู 3-5 ุนูุงุฑุงุช ูุงุนุฏุฉ
2. ุฏุฑุงุณุฉ ุงูุฌุฏูู ุงูุชูุตูููุฉ ููู ุนูุงุฑ
3. ุงูุชูุงูุถ ุนูู ุงูุณุนุฑ ุงููุซุงูู
4. ุฅุชูุงู ุงูุตููุฉ ุจุฃูุถู ุงูุดุฑูุท

๐ **ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุงูููู (6-24 ุดูุฑ)**
1. ุชุทููุฑ ุงูุฎุฏูุงุช ูุฒูุงุฏุฉ ุงููููุฉ ุงูุฅูุฌุงุฑูุฉ
2. ูุชุงุจุนุฉ ุชุทูุฑุงุช ุงูุณูู ุดูุฑูุงู
3. ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฃุฌุฑูู
4. ุฏุฑุงุณุฉ ูุฑุต ุฅุนุงุฏุฉ ุงูุชูููู

๐ **ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ุงูุชูุณุน (24-60 ุดูุฑ)**
1. ุงูุชูุณุน ูู ุงูุงุณุชุซูุงุฑ ุจุงูููุทูุฉ
2. ุจูุงุก ูุญูุธุฉ ุนูุงุฑูุฉ ูุชููุนุฉ
3. ุงูุงุณุชูุงุฏุฉ ูู ูุดุงุฑูุน ุงูุชุทููุฑ ุงููุงุฏูุฉ
4. ุงูุชุญูู ุฅูู ูุณุชุซูุฑ ูุญุชุฑู

**ุงูุชูุตูุฉ ุงูุดุฎุตูุฉ:**
ุฃูุตุญูู ุจุงูุชุฑููุฒ ุนูู ุงูุฌูุฏุฉ ูุงูุชููุฒ ูู ุงูุฎุฏูุฉุ ูููุง ููุชุงุญ ุงููุฌุงุญ ูู ุงูุณูู ุงูุนูุงุฑู ุงูุณุนูุฏู.
        """,
        
        "๐ ุชุญููู ุงูุณูู ุงูุชูุตููู": """
**ูุคุดุฑุงุช ุงูุณูู ุงูุญูููุฉ:**

๐ **ูุคุดุฑุงุช ุงูููู:**
- ููู ุงูุทูุจ ุงูุณููู: +15.2% ุณูููุงู
- ููู ุงููููุฉ ุงูุณูููุฉ: +8.7% ุณูููุงู
- ููู ุงูููุฉ ุงูุดุฑุงุฆูุฉ: +6.3% ุณูููุงู

๐๏ธ **ูุดุงุฑูุน ุงูุชุทููุฑ ุงููุงุฏูุฉ:**
- ูุดุฑูุน ุงููุฏูุฉ: ุงุณุชุซูุงุฑ 500 ูููุงุฑ ุฑูุงู
- ูุดุฑูุน ูููู: ุงุณุชุซูุงุฑ 300 ูููุงุฑ ุฑูุงู
- ูุดุฑูุน ุงูุจุญุฑ ุงูุฃุญูุฑ: ุงุณุชุซูุงุฑ 200 ูููุงุฑ ุฑูุงู

๐ฅ **ุงูุชุญููู ุงูุฏูููุบุฑุงูู:**
- ููู ุงูุณูุงู: +2.4% ุณูููุงู
- ุฏุฎู ุงููุฑุฏ: 85,000 ุฑูุงู ุดูุฑูุงู
- ูุณุจุฉ ุงูุดุจุงุจ: 67% ูู ุงูุณูุงู

**ุงูุชููุนุงุช ุงููุณุชูุจููุฉ:**
- ููู ุงูุณูู ุงูุนูุงุฑู 2024: +9.2%
- ููู ุงูุณูู ุงูุนูุงุฑู 2025: +10.5%
- ููู ุงูุณูู ุงูุนูุงุฑู 2026: +11.8%
        """,
        
        "๐ก๏ธ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ ุงููุชูุฏูุฉ": """
**ุชุญููู ุงููุฎุงุทุฑ ุงูุดุงูู:**

๐ด **ุงููุฎุงุทุฑ ุงูุนุงููุฉ (30%):**
- ุชููุจุงุช ุฃุณุนุงุฑ ุงูููุงุฏ ุงูุฅูุดุงุฆูุฉ
- ุชุบูุฑ ุณูุงุณุงุช ุงูุชูููู ุงูุนูุงุฑู
- ุงูููุงูุณุฉ ูู ุงููุดุงุฑูุน ุงูุฌุฏูุฏุฉ

๐ก **ุงููุฎุงุทุฑ ุงููุชูุณุทุฉ (50%):**
- ุชุบูุฑ ุฃููุงุท ุงูุทูุจ ุงูุณููู
- ุชูุงููู ุงูุตูุงูุฉ ุบูุฑ ุงููุชููุนุฉ
- ุชุบูุฑ ุงูุธุฑูู ุงูุงูุชุตุงุฏูุฉ

๐ข **ุงููุฎุงุทุฑ ุงูููุฎูุถุฉ (20%):**
- ูุดุงูู ูุงููููุฉ ูุฅุฏุงุฑูุฉ
- ุตุนูุจุฉ ูู ุฅูุฌุงุฏ ูุณุชุฃุฌุฑูู
- ุชุบูุฑ ุฃุณุนุงุฑ ุงููุงุฆุฏุฉ

**ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุฎููู:**
1. ุงูุชูููุน ุงูุฌุบุฑุงูู ุนุจุฑ 3 ููุงุทู ูุฎุชููุฉ
2. ุจูุงุก ุงุญุชูุงุทู ููุฏู ูู 6 ุฃุดูุฑ
3. ุชุฃููู ุดุงูู ุถุฏ ุฌููุน ุงููุฎุงุทุฑ
4. ุนููุฏ ุชุญูุท ุถุฏ ุชููุจุงุช ุงูุฃุณุนุงุฑ
        """,
        
        "๐ ูุฑุต ุงูููู ุงูุงุณุชุซูุงุฆูุฉ": """
**ุงููุฑุต ุงูุฐูุจูุฉ ูู ุงูุณูู:**

๐ฅ **ุงููุฑุตุฉ ุงูุฃููู: ุงูููุงุทู ุงูุดูุงููุฉ**
- ูุนุฏู ููู ูุชููุน: 18% ุณูููุงู
- ุญุฌู ุงูุงุณุชุซูุงุฑุงุช: 500 ูููุงุฑ ุฑูุงู
- ุงูุชูููุช: 2024-2026
- ุงูุชูุตูุฉ: ุงูุงุณุชุซูุงุฑ ุงููุจูุฑ

๐ฅ **ุงููุฑุตุฉ ุงูุซุงููุฉ: ุงูููุงุทู ุงููุฑูุฒูุฉ**  
- ูุนุฏู ููู ูุชููุน: 14% ุณูููุงู
- ุญุฌู ุงูุงุณุชุซูุงุฑุงุช: 200 ูููุงุฑ ุฑูุงู
- ุงูุชูููุช: 2024-2025
- ุงูุชูุตูุฉ: ุงูุงุณุชุซูุงุฑ ุงููุชูุณุท

๐ฅ **ุงููุฑุตุฉ ุงูุซุงูุซุฉ: ุงูููุงุทู ุงูุณูููุฉ**
- ูุนุฏู ููู ูุชููุน: 12% ุณูููุงู
- ุญุฌู ุงูุงุณุชุซูุงุฑุงุช: 150 ูููุงุฑ ุฑูุงู
- ุงูุชูููุช: 2024-2027
- ุงูุชูุตูุฉ: ุงูุงุณุชุซูุงุฑ ุงูุขูู

**ุงููุฑุต ุงููุงุดุฆุฉ:**
- ุงูุนูุงุฑุงุช ุงูุฐููุฉ: +25% ููู ูุชููุน
- ุงููุจุงูู ุงูุฎุถุฑุงุก: +22% ููู ูุชููุน
- ุงููุฌูุนุงุช ุงููุชูุงููุฉ: +18% ููู ูุชููุน
        """,
        
        "๐ก ูุตุงุฆุญ ุงูุฎุจุฑุงุก": """
**ุญููุฉ ูู ูุงูุน ุงูุชุฌุฑุจุฉ:**

๐ **ูู ูุณุชุซูุฑ ูุงุฌุญ:**
"ุงููุฌุงุญ ูู ุงูุนูุงุฑุงุช ูุง ูุฃุชู ูู ุงูุตููุงุช ุงููุจูุฑุฉุ ุจู ูู ุงููุฑุงุฑุงุช ุงูุตุญูุญุฉ ุงููุชุชุงููุฉ"

๐ผ **ูู ูุณูุท ูุญุชุฑู:**
"ุฃูุถู ุงุณุชุซูุงุฑ ูู ุงูุฐู ุชูููู ุชูุงูุงู ูุชุดุนุฑ ุจุงูุฑุงุญุฉ ุชุฌุงู ูุฎุงุทุฑู"

๐ **ูู ูุทูุฑ ุนูุงุฑู:**
"ุงูุฌูุฏุฉ ุชุจูู ุงูุณูุนุฉุ ูุงูุณูุนุฉ ุชุจูู ุงูุซุฑูุฉ"

**ูุตุงุฆุญ ุนูููุฉ:**
1. ุงุฏุฑุณ ุงูุณูู ููุฏุฉ 3 ุฃุดูุฑ ูุจู ุงูุงุณุชุซูุงุฑ
2. ุงุณุชุดุฑ ุฃูุซุฑ ูู ุฎุจูุฑ ูุจู ุงุชุฎุงุฐ ุงููุฑุงุฑ
3. ูุง ุชุณุชุซูุฑ ุฃูุซุฑ ูู 30% ูู ุฑุฃุณ ูุงูู ูู ุตููุฉ ูุงุญุฏุฉ
4. ุญุงูุธ ุนูู ุณูููุฉ ูุงููุฉ ููุทูุงุฑุฆ
5. ุชุงุจุน ุงูุณูู ุฃุณุจูุนูุงู ููู ูุณุชุนุฏุงู ููุชุนุฏูู
        """,
        
        "๐ ุฎุทุฉ ุงูุชูููุฐ ุงูุชูุตูููุฉ": """
**ุงูุฎุทูุงุช ุงูุนูููุฉ ูููุฌุงุญ:**

๐ **ุงูุฃุณุจูุน 1-4: ุงูุฏุฑุงุณุฉ ูุงูุจุญุซ**
- ุชุญููู 50 ุนูุงุฑ ูุดุงุจู
- ุฏุฑุงุณุฉ 10 ูุดุงุฑูุน ููุงูุณุฉ
- ููุงุจูุฉ 5 ูุณุทุงุก ูุชุฎุตุตูู
- ุฒูุงุฑุฉ 3 ููุงุทู ูุณุชูุฏูุฉ

๐ **ุงูุดูุฑ 2-3: ุงูุชูุงูุถ ูุงูุดุฑุงุก**
- ุงูุชูุงูุถ ุนูู 3 ุนูุงุฑุงุช ูุงุนุฏุฉ
- ุฏุฑุงุณุฉ ุงูุฌุฏูู ุงูุชูุตูููุฉ
- ุชุฃููู ุงูุชูููู ุงูููุงุณุจ
- ุฅุชูุงู ุงูุตููุฉ ุงูุฃูุถู

๐ **ุงูุดูุฑ 4-6: ุงูุชุทููุฑ ูุงูุชุฃุฌูุฑ**
- ุชุฌููุฒ ุงูุนูุงุฑ ุจุฃูุถู ุงูููุงุตูุงุช
- ูุถุน ุฎุทุฉ ุชุณููููุฉ ููุซูุฉ
- ุงุฎุชูุงุฑ ุงููุณุชุฃุฌุฑูู ุงูููุงุณุจูู
- ุจุฏุก ุชุญููู ุงูุนูุงุฆุฏ

**ูุคุดุฑุงุช ุงููุฌุงุญ:**
- ุชุญููู 80% ุฅุดุบุงู ุฎูุงู 3 ุฃุดูุฑ
- ุนุงุฆุฏ 8% ุนูู ุงูุงุณุชุซูุงุฑ ุณูููุงู
- ููู ุงููููุฉ ุงูุณูููุฉ 10% ุณูููุงู
        """,
        
        "๐ฎ ุชููุนุงุช ุงููุณุชูุจู": """
**ุฑุคูุฉ 2030 ูุชุฃุซูุฑูุง ุนูู ุงูุนูุงุฑุงุช:**

๐๏ธ **ุงูุชุฃุซูุฑุงุช ุงูุฅูุฌุงุจูุฉ:**
- ููู ุงูุงุณุชุซูุงุฑุงุช ุงูุฃุฌูุจูุฉ: +40%
- ุฒูุงุฏุฉ ุงูุณูุงุญุฉ: +25 ููููู ุณุงุฆุญ
- ููู ุงูุงูุชุตุงุฏ: +3.5% ุณูููุงู
- ุชุญุณูู ุงูุจููุฉ ุงูุชุญุชูุฉ: +200%

๐ **ุงูุชููุนุงุช ุงูุงูุชุตุงุฏูุฉ:**
- ููู ุงููุงุชุฌ ุงููุญูู: 3.8% ุณูููุงู
- ุงุฑุชูุงุน ุงุญุชูุงุทู ุงูููุฏ ุงูุฃุฌูุจู: 2.1 ุชุฑููููู ุฑูุงู
- ููู ุงูุตุงุฏุฑุงุช ุบูุฑ ุงูููุทูุฉ: +12%

๐ฏ **ุงููุฑุต ุงููุณุชูุจููุฉ:**
- ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุนูุงุฑุงุช: +35% ููู
- ุงูุงุณุชุฏุงูุฉ ูุงูุทุงูุฉ ุงูุฎุถุฑุงุก: +28% ููู
- ุงูุชูููููุฌูุง ุงููุงููุฉ: +22% ููู
        """,
        
        "๐ ุงูุฎูุงุตุฉ ูุงูุชูุตูุงุช": """
**ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ูุงูุชูุตูุงุช:**

โ **ุงูุชูููู ุงูููุงุฆู:**
- ุชุตููู ุงูุงุณุชุซูุงุฑ: ๐ข ููุชุงุฒ
- ูุณุชูู ุงููุฎุงุทุฑุฉ: ๐ก ูุชูุณุทุฉ
- ุงูุชูุตูุฉ: ๐ข ุดุฑุงุก ูุณุชุนุฌู

๐ฏ **ุงูุชูุตูุงุช ุงูุงุณุชุฑุงุชูุฌูุฉ:**
1. ุงูุงุณุชุซูุงุฑ ุงูููุฑู ูู ุงูููุทูุฉ
2. ุงูุชุฑููุฒ ุนูู ุงูููุนูุฉ ูุง ุงููููุฉ
3. ุงูุชูููุน ูู ุงููุญูุธุฉ ุงูุงุณุชุซูุงุฑูุฉ
4. ุงููุชุงุจุนุฉ ุงููุณุชูุฑุฉ ููุณูู

**ุฎุงุชูุฉ:**
ูุฐุง ููุณ ูุฌุฑุฏ ุชูุฑูุฑุ ุจู ูู ุฎุฑูุทุฉ ุทุฑูู ูุญู ุงููุฌุงุญ ุงูุงุณุชุซูุงุฑู. ุซู ุจูุฏุฑุงุชู ูุงุชุฎุฐ ุงููุฑุงุฑ ุงููุฏุฑูุณ.
        """
    }
    
    # ุฅุถุงูุฉ ูุณู ุฎุงุต ูููุคุซุฑูู
    if user_type == "ูุคุซุฑ":
        report_sections["๐ ูุฏูุฉ Warda Intelligence"] = """
        **ุนุฒูุฒู ุงููุคุซุฑ ุงููุฑููุ**

        ููุฏู ูู ูุฐุง ุงูุชูุฑูุฑ ุงูุฐูุจู ููุฏูุฉ ุญุตุฑูุฉ ุชูุฏูุฑุงู ูุชุฃุซูุฑู ุงูุฅูุฌุงุจู ูู ุงููุฌุชูุน.

        **ูุงุฐุง ุชุญุตู ุนููู ูุฌุงูุงูุ**
        ๐ฅ ุชูุฑูุฑ ุฐูุจู ุจูููุฉ 79 ุฏููุงุฑ
        ๐ 10 ุตูุญุงุช ูู ุงูุชุญููู ุงููุชูุฏู
        ๐ฏ ุฑุณููุงุช ุจูุงููุฉ ุชูุงุนููุฉ
        ๐ก ูุตุงุฆุญ ุงุณุชุซูุงุฑูุฉ ุญุตุฑูุฉ

        **ููู ุชุฏุนููุงุ**
        ุจูุดุงุฑูุชู ุชุฌุฑุจุชู ูุน ููุตุฉ Warda Intelligenceุ ูุฃูุช ุชุณุงุนุฏ ูู:
        - ูุดุฑ ุงูุซูุงูุฉ ุงูุงุณุชุซูุงุฑูุฉ ุงููุงุนูุฉ
        - ุฏุนู ููุตุฉ ุนุฑุจูุฉ ูุชุฎุตุตุฉ
        - ุชูููู ุงููุณุชุซูุฑูู ูู ุงุชุฎุงุฐ ูุฑุงุฑุงุช ูุฏุฑูุณุฉ

        **ุดูุฑุงู ููููู ุฌุฒุกุงู ูู ูุฌุงุญูุง!**

        *ูุฑูู Warda Intelligence*
        """
    
    return report_sections

# === ุงููุงุฌูุฉ ุงูุฑุฆูุณูุฉ ===
col1, col2 = st.columns([1, 1])

with col1:
    st.markdown("### ๐ค ุจูุงูุงุช ุงููุณุชุฎุฏู")
    
    user_type = st.selectbox("ุงุฎุชุฑ ูุฆุชู:", 
                           ["ูุณุชุซูุฑ", "ูุณูุท ุนูุงุฑู", "ุดุฑูุฉ ุชุทููุฑ", "ูุฑุฏ", "ุจุงุญุซ ุนู ูุฑุตุฉ", "ูุงูู ุนูุงุฑ"])
    
    city = st.selectbox("ุงููุฏููุฉ:", 
                       ["ุงูุฑูุงุถ", "ุฌุฏุฉ", "ุงูุฏูุงู", "ููุฉ ุงูููุฑูุฉ", "ุงููุฏููุฉ ุงููููุฑุฉ", "ุงูุฎุจุฑ", "ุชุจูู", "ุงูุทุงุฆู"])
    
    property_type = st.selectbox("ููุน ุงูุนูุงุฑ:", 
                                ["ุดูุฉ", "ูููุง", "ุฃุฑุถ", "ูุญู ุชุฌุงุฑู"])
    
    status = st.selectbox("ุงูุญุงูุฉ:", ["ููุจูุน", "ููุดุฑุงุก", "ููุฅูุฌุงุฑ"])
    
    area = st.slider("ุงููุณุงุญุฉ (ูยฒ):", 50, 1000, 120)

with col2:
    st.markdown("### ๐ ุงุฎุชูุงุฑ ุงูุจุงูุฉ")
    
    property_count = st.slider("๐ข ุนุฏุฏ ุงูุนูุงุฑุงุช ููุชุญููู:", 1, 1000, 1,
                              help="ูููุง ุฒุงุฏ ุนุฏุฏ ุงูุนูุงุฑุงุชุ ุฒุงุฏุช ุฏูุฉ ุงูุชุญููู ูุงูุณุนุฑ")
    
    chosen_pkg = st.radio("ุงุฎุชุฑ ุจุงูุชู:", list(PACKAGES.keys()))
    
    base_price = PACKAGES[chosen_pkg]["price"]
    total_price = base_price * property_count
    
    st.markdown(f"""
    <div class='package-card'>
    <h3>ุจุงูุฉ {chosen_pkg}</h3>
    <h4>{total_price} ุฏููุงุฑ</h4>
    </div>
    """, unsafe_allow_html=True)
    
    st.markdown("**ุงููููุฒุงุช:**")
    for feature in PACKAGES[chosen_pkg]["features"]:
        st.write(f"โ {feature}")

# === ูุธุงู ุงูุฏูุน ===
st.markdown("---")
st.markdown(f"### ๐ฐ ุงูุณุนุฑ ุงูููุงุฆู: **{total_price} ุฏููุงุฑ**")

paypal_html = f"""
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_xclick">
<input type="hidden" name="business" value="zeghloulwarda6@gmail.com">
<input type="hidden" name="item_name" value="ุชูุฑูุฑ {chosen_pkg} - {property_count} ุนูุงุฑ">
<input type="hidden" name="amount" value="{total_price}">
<input type="hidden" name="currency_code" value="USD">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_buynowCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!" style="display: block; margin: 0 auto;">
</form>
"""

st.markdown(paypal_html, unsafe_allow_html=True)

# === ุฅูุดุงุก ุงูุชูุฑูุฑ ===
st.markdown("---")
st.markdown("### ๐ ุฅูุดุงุก ุงูุชูุฑูุฑ")

if st.button("๐ฏ ุฅูุดุงุก ุงูุชูุฑูุฑ ุงููุชูุฏู (PDF)", use_container_width=True):
    with st.spinner("๐ ุฌุงุฑู ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูุงุญุชุฑุงูู... ูุฏ ูุณุชุบุฑู ุจุถุน ุซูุงูู"):
        try:
            market_data = generate_advanced_market_data(city, property_type, status)
            report_data = generate_executive_report(user_type, city, property_type, area, status, chosen_pkg)
            user_info = {
                "user_type": user_type,
                "city": city, 
                "property_type": property_type,
                "area": area,
                "package": chosen_pkg
            }
            
            # ุฅูุดุงุก ุงูุฑุณููุงุช ุงูุจูุงููุฉ ููุจุงูุงุช ุงููุฏููุนุฉ
            if chosen_pkg != "ูุฌุงููุฉ":
                st.markdown("### ๐ ุงูุฑุณูู ุงูุจูุงููุฉ ุงููุชูุฏูุฉ")
                fig_returns, fig_growth = create_advanced_visualizations(market_data, user_type)
                
                col1, col2 = st.columns(2)
                with col1:
                    st.plotly_chart(fig_returns, use_container_width=True)
                with col2:
                    st.plotly_chart(fig_growth, use_container_width=True)
            
            pdf_buffer = create_professional_arabic_pdf(report_data, user_info)
            
            st.session_state.pdf_data = pdf_buffer.getvalue()
            st.session_state.report_generated = True
            
            st.success("โ ุชู ุฅูุดุงุก ุงูุชูุฑูุฑ ุงูุงุญุชุฑุงูู ุจูุฌุงุญ!")
            st.balloons()
            
        except Exception as e:
            st.error(f"โ๏ธ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅูุดุงุก ุงูุชูุฑูุฑ: {str(e)}")
            st.info("ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชูุงุตู ูุน ุงูุฏุนู")

if st.session_state.get('report_generated', False):
    st.markdown("---")
    st.markdown("## ๐ ุงูุชูุฑูุฑ ุงูููุงุฆู ุงูุฌุงูุฒ ููุทุจุงุนุฉ")
    
    # ุฒุฑ ุชุญููู PDF
    st.download_button(
        label="๐ฅ ุชุญููู ุงูุชูุฑูุฑ PDF",
        data=st.session_state.pdf_data,
        file_name=f"ุชูุฑูุฑ_Warda_Intelligence_{datetime.now().strftime('%Y%m%d_%H%M')}.pdf",
        mime="application/pdf",
        use_container_width=True
    )
    
    st.info("""
    **๐ ุงูุชูุฑูุฑ ุฌุงูุฒ ููุทุจุงุนุฉ ูุงูุชูุฏูู:**
    - ุชุตููู ุงุญุชุฑุงูู ููุงุณุจ ููุนุฑูุถ ุงูุชูุฏูููุฉ
    - ูุญุชูู ุนุฑุจู ููุธู ููุงุถุญ
    - ููุงุณุจ ููุชูุฏูู ููุดุฑูุงุช ูุงููุณุชุซูุฑูู
    - ูุญุชูู ุนูู ุฌููุน ุงูุชุญูููุงุช ุงููุทููุจุฉ
    - 10 ุตูุญุงุช ูู ุงููุญุชูู ุงูุซุฑู ูุงูุดุงูู
    """)

# === ููุญุฉ ุงููุณุคูู ===
admin_password = st.sidebar.text_input("ูููุฉ ูุฑูุฑ ุงููุณุคูู:", type="password")
if admin_password == "WardaAdmin2024":
    st.sidebar.success("๐ ูุฑุญุจุงู ุจู ูู ููุญุฉ ุงูุชุญูู!")
    
    st.sidebar.markdown("### ๐๏ธ ููุญุฉ ุชุญูู ุงููุณุคูู")
    
    # ุฅูุดุงุก ุฑูุงุจุท ูุคุซุฑูู
    st.sidebar.markdown("#### ๐ ุฅุฏุงุฑุฉ ุฑูุงุจุท ุงููุคุซุฑูู")
    
    influencer_name = st.sidebar.text_input("ุงุณู ุงููุคุซุฑ:")
    
    if st.sidebar.button("๐ ุฅูุดุงุก ุฑุงุจุท ูุคุซุฑ ุฌุฏูุฏ"):
        if influencer_name:
            today = datetime.now().strftime("%Y%m%d")
            influencer_token = hashlib.md5(f"GOLD_{influencer_name}_{today}_{np.random.randint(1000,9999)}".encode()).hexdigest()[:12]
            influencer_url = f"https://warda-intelligence.streamlit.app/?promo={influencer_token}"
            
            st.session_state.influencer_url = influencer_url
            st.session_state.influencer_name = influencer_name
            
            st.sidebar.success(f"โ ุชู ุฅูุดุงุก ุงูุฑุงุจุท ูููุคุซุฑ: {influencer_name}")
        else:
            st.sidebar.error("โ๏ธ ูุฑุฌู ุฅุฏุฎุงู ุงุณู ุงููุคุซุฑ")
    
    if hasattr(st.session_state, 'influencer_url'):
        st.sidebar.markdown("**๐ ุงูุฑุงุจุท ุงูุญุตุฑู:**")
        st.sidebar.code(st.session_state.influencer_url)
        
        st.sidebar.markdown(f"**๐ ูุนูููุงุช ุงูุฑุงุจุท:**")
        st.sidebar.markdown(f"- ุงููุคุซุฑ: {st
