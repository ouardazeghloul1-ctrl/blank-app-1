smart_report_system.py - ุงููุธุงู ุงูุฐูู ููุชูุงุฑูุฑ ุญุณุจ ุงููุฆุฉ ูุงูุจุงูุฉ
import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import matplotlib.pyplot as plt
from io import BytesIO
import arabic_reshaper
from bidi.algorithm import get_display
import math

def safe_num(val, fmt=",.0f", default="N/A"):
    """ุชุฑุฌุน ูููุฉ ููุณูุฉ ุฃู ูููุฉ ุงูุชุฑุงุถูุฉ ุฅุฐุง ูุงู val ุบูุฑ ุตุงูุญ."""
    try:
        if val is None:
            return default
        if isinstance(val, (list, tuple, set)):
            return default
        if isinstance(val, float) and math.isnan(val):
            return default
        return format(val, fmt)
    except Exception:
        return default

# ๐ง ุงูุชุนุฏูู 2: ุฏุงูุฉ ุงูุญูุงูุฉ ุงูุฑูุงุถูุฉ
def safe_div(a, b, default=0):
    """ุชูุณูู ุขูู ูุญูู ูู ุงููุณูุฉ ุนูู ุตูุฑ ุฃู ููู ุฎุงุทุฆุฉ"""
    try:
        if b in [0, None, 0.0]:
            return default
        return a / b
    except (ZeroDivisionError, TypeError, ValueError):
        return default

class SmartReportSystem:
    def __init__(self, user_data):
        # ๐ง ุงูุชุนุฏูู ุงูุฃูู: ุชุซุจูุช ุงููุชุบูุฑุงุช ุงูุฃุณุงุณูุฉ
        self.user_data = user_data
        self.category = user_data.get("category", "investor")
        self.city = user_data.get("city", "")
        self.plan = user_data.get("plan", "ูุฌุงููุฉ")
        self.user_type = user_data.get("user_type", "ูุณุชุซูุฑ")
        
        # ุฎุฑูุทุฉ ุชุตููู ุงููุณุชุฎุฏููู
        self.category_map = {
            "investor": "ูุณุชุซูุฑ",
            "broker": "ูุณูุท ุนูุงุฑู",
            "developer": "ุดุฑูุฉ ุชุทููุฑ",
            "individual": "ูุฑุฏ",
            "opportunity": "ุจุงุญุซ ุนู ูุฑุตุฉ",
            "owner": "ูุงูู ุนูุงุฑ"
        }
        
        # ุงูุญุตูู ุนูู ุงููุฆุฉ ุงูููุณูุฉ
        self.normalized_category = self.category_map.get(self.category, "ูุณุชุซูุฑ")
        
        # ูุธุงู ุงูุจุงูุงุช
        self.package_features = {
            "ูุฌุงููุฉ": {"pages": 15, "analysis_depth": "basic", "charts": 3},
            "ูุถูุฉ": {"pages": 35, "analysis_depth": "advanced", "charts": 8},
            "ุฐูุจูุฉ": {"pages": 60, "analysis_depth": "premium", "charts": 15},
            "ูุงุณูุฉ": {"pages": 90, "analysis_depth": "vip", "charts": 25},
            "ูุงุณูุฉ ูุชููุฒุฉ": {"pages": 120, "analysis_depth": "ultimate", "charts": 35}
        }
        
        # ูุธุงู ุงููุฏู ุงูุฐูู
        self.city_insights = {
            "ุงูุฑูุงุถ": {
                "growth_trend": 2.8,
                "strength": "ุฑุคูุฉ 2030 ูุงููุดุงุฑูุน ุงููุจุฑู",
                "opportunity": "ุงูุชุญูู ุงูุงูุชุตุงุฏู ูุงูููู ุงูุณูุงูู",
                "description": "ุงูุนุงุตูุฉ ุงูุงูุชุตุงุฏูุฉ ูุงูููุจ ุงููุงุจุถ ููููููุฉ"
            },
            "ุฌุฏุฉ": {
                "growth_trend": 2.2,
                "strength": "ุงููููุน ุงูุงุณุชุฑุงุชูุฌู ูุงููุดุงุฑูุน ุงูุณูุงุญูุฉ", 
                "opportunity": "ุงูุงุณุชุซูุงุฑุงุช ุงููุจุฑู ูุงูุจููุฉ ุงูุชุญุชูุฉ",
                "description": "ุนุฑูุณ ุงูุจุญุฑ ุงูุฃุญูุฑ ูุงูุนุงุตูุฉ ุงูุชุฌุงุฑูุฉ"
            },
            "ููุฉ ุงูููุฑูุฉ": {
                "growth_trend": 2.5,
                "strength": "ุงููููุน ุงูุฏููู ูุงูุทูุจ ุงููุณุชูุฑ",
                "opportunity": "ุงููุดุงุฑูุน ุงูุชููููุฉ ูุงูุฎุฏูุงุช",
                "description": "ุฃุทูุฑ ุจูุงุน ุงูุฃุฑุถ ูุงูุนุงุตูุฉ ุงูุฏูููุฉ ุงูุนุงูููุฉ"
            },
            "ุงููุฏููุฉ ุงููููุฑุฉ": {
                "growth_trend": 2.1,
                "strength": "ุงูุงุณุชูุฑุงุฑ ุงูุณููู ูุงููููุน ุงูุฏููู",
                "opportunity": "ุงูุชูุณุน ุงูุนูุฑุงูู ูุงูุฎุฏูุงุช",
                "description": "ูุฏููุฉ ุงููุจู ุตูู ุงููู ุนููู ูุณูู - ุทูุจุฉ ุงูุทูุจุฉ"
            },
            "ุงูุฏูุงู": {
                "growth_trend": 1.9,
                "strength": "ุงูุชูููุน ุงูุงูุชุตุงุฏู ูุงููููุน ุงูุงุณุชุฑุงุชูุฌู",
                "opportunity": "ุงููุดุงุฑูุน ุงูุตูุงุนูุฉ ูุงูููุฌุณุชูุฉ",
                "description": "ุนุงุตูุฉ ุงูููุทูุฉ ุงูุดุฑููุฉ ูุงูููุจ ุงููุงุจุถ ููุทุงูุฉ"
            }
        }
    
    def arabic_text(self, text):
        """ุชุญููู ุงููุต ุงูุนุฑุจู ููุนุฑุถ ุงูุตุญูุญ"""
        return get_display(arabic_reshaper.reshape(str(text)))
    
    def generate_extended_report(self, user_info, market_data, real_data, chosen_pkg):
        """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ - ุชูููุฏ ุชูุฑูุฑ ุฐูู ุญุณุจ ุงููุฆุฉ"""
        
        # ๐ง ุงูุชุนุฏูู 2: ุญุงุฑุณ ุฌูุฏุฉ ุงูุชูุฑูุฑ
        if not market_data or not isinstance(market_data, dict):
            market_data = {
                'ูุชูุณุท_ุงูุณูู': 6000,
                'ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู': 7.5,
                'ูุนุฏู_ุงูููู_ุงูุดูุฑู': 2.5,
                'ูุคุดุฑ_ุงูุณูููุฉ': 85,
                'ุญุฌู_ุงูุชุฏุงูู_ุดูุฑู': 120,
                'ุทุงูุจ_ุงูุดุฑุงุก': 180,
                'ุนุฑุถ_ุงูุนูุงุฑุงุช': 100,
                'ูุนุฏู_ุงูุฅุดุบุงู': 90,
                'ุฃูู_ุณุนุฑ': 4200,
                'ุฃุนูู_ุณุนุฑ': 9000
            }
        
        # ุชูุญูุฏ ูุตุฏุฑ ุงููุฏููุฉ
        user_city = self.city or user_info.get('city', 'ุงููุฏููุฉ ุงููุณุชูุฏูุฉ')
        
        # ุงุณุชุฎุฏุงู self.category ููุท
        if self.category == "investor":
            return self._investor_report(user_info, market_data, real_data, chosen_pkg, user_city)
            
        elif self.category == "broker":
            return self._broker_report(user_info, market_data, real_data, chosen_pkg, user_city)
            
        elif self.category == "developer":
            return self._developer_report(user_info, market_data, real_data, chosen_pkg, user_city)
            
        elif self.category == "individual":
            return self._individual_report(user_info, market_data, real_data, chosen_pkg, user_city)
            
        elif self.category == "opportunity":
            return self._opportunity_seeker_report(user_info, market_data, real_data, chosen_pkg, user_city)
            
        elif self.category == "owner":
            return self._owner_report(user_info, market_data, real_data, chosen_pkg, user_city)
            
        else:
            return self._general_report(user_info, market_data, real_data, chosen_pkg, user_city)
    
    def _investor_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐ค ุชูุฑูุฑ ุงููุณุชุซูุฑ - ูุฑูุฒ ุนูู ุงูุนูุงุฆุฏ ูุงููุฎุงุทุฑ"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        price_per_area = market_data.get('ูุชูุณุท_ุงูุณูู', 0) * user_info.get('area', 120)
        demand_supply_ratio = safe_div(
            market_data.get('ุทุงูุจ_ุงูุดุฑุงุก', 0),
            market_data.get('ุนุฑุถ_ุงูุนูุงุฑุงุช', 1),
            1.0
        )
        
        report = f"""
๐ฆ **ุชูุฑูุฑ ุงููุณุชุซูุฑ ุงูุนูุงุฑู ุงููุชูุฏู - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ุงูุชุญููู ุงูุงุณุชุซูุงุฑู ูู {user_city}:**

๐ **ูุคุดุฑุงุช ุงูุณูู ุงูุฑุฆูุณูุฉ:**
โข ูุชูุณุท ุณุนุฑ ุงููุชุฑ: {safe_num(market_data.get('ูุชูุณุท_ุงูุณูู', 0))} ุฑูุงู
โข ูุชูุณุท ุณุนุฑ ุงููุณูู: {safe_num(price_per_area)} ุฑูุงู
โข ุงูุนุงุฆุฏ ุงูุชุฃุฌูุฑู: {safe_num(market_data.get('ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู', 0), '.1f')}%
โข ูุนุฏู ุงูููู ุงูุดูุฑู: {safe_num(market_data.get('ูุนุฏู_ุงูููู_ุงูุดูุฑู', 0), '.1f')}%
โข ูุคุดุฑ ุงูุณูููุฉ: {safe_num(market_data.get('ูุคุดุฑ_ุงูุณูููุฉ', 0), '.0f')}%
โข ูุณุจุฉ ุงูุนุฑุถ ููุทูุจ: 1 : {safe_num(demand_supply_ratio, '.1f')}

๐ฏ **ุงูุชูุตูุงุช ุงูุงุณุชุฑุงุชูุฌูุฉ ูููุณุชุซูุฑ:**

1. **๐ ุชุญููู ุงููุฑุต:**
   - ุงูุชุฑููุฒ ุนูู ุงูุนูุงุฑุงุช ุฐุงุช ุงูุนุงุฆุฏ ููู {safe_num(market_data.get('ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู', 0) + 2, '.1f')}%
   - ุงุณุชูุฏุงู ุงูููุงุทู ุฐุงุช ุงูููู ููู ุงููุชูุณุท ูู {user_city}
   - ุชูููุน ุงููุญูุธุฉ ุจูู 3-5 ููุงุทู ูุฎุชููุฉ

2. **๐ก๏ธ ุฅุฏุงุฑุฉ ุงููุฎุงุทุฑ:**
   - ุชูุฒูุน ุงููุฎุงุทุฑ: 60% ููุฎูุถุฉุ 30% ูุชูุณุทุฉุ 10% ูุฑุชูุนุฉ
   - ุงูุญูุงุธ ุนูู ุณูููุฉ ุทุงุฑุฆุฉ 10-15%
   - ุงุณุชุฎุฏุงู ุงูุชุญูุท ุถุฏ ุชููุจุงุช ุงูุณูู

3. **๐ฐ ุงูุชูููุช ุงูุงุณุชุซูุงุฑู:**
   - ุดุฑุงุก ููุฑู: ูู ุญุงูุฉ ุงูููู > 3% ูุงูุณูููุฉ > 80%
   - ุดุฑุงุก ุชุฏุฑูุฌู: ูู ุญุงูุฉ ุงูููู 1-3%
   - ุงูุชุธุงุฑ: ูู ุญุงูุฉ ุงูููู < 1%

๐ก **ุฑุคูุฉ ุงูุฎุจุฑุงุก:**
"ุงูุงุณุชุซูุงุฑ ูู {user_city} ูุชุทูุจ ุงุณุชุฑุงุชูุฌูุฉ ูุงุถุญุฉ ููุฑููุฉ ูู ุงูุชูููุฐ. 
ุงููุฑุต ุงูุญุงููุฉ ูู ุณูู {user_city} ููุชุงุฒุฉ ูููุณุชุซูุฑูู ุฐูู ุงูุฑุคูุฉ ุงูุทูููุฉ ุงูุฃูุฏ."

๐ **ููุญุตูู ุนูู ุชุญููู ูุชุนูู:**
ุชูุงุตู ูุน ูุณุชุดุงุฑููุง ุงููุชุฎุตุตูู ูุชุญููู ูุญูุธุชู ุงูุญุงููุฉ ูุชุทููุฑ ุงุณุชุฑุงุชูุฌูุฉ ุงุณุชุซูุงุฑูุฉ ูุฎุตุตุฉ.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุงููุณุชุซูุฑ")
    
    def _broker_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐งโ๐ผ ุชูุฑูุฑ ุงููุณูุท ุงูุนูุงุฑู - ูุฑูุฒ ุนูู ุงูุตููุงุช ูุงูุฃุณูุงู"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        demand_supply_ratio = safe_div(
            market_data.get('ุทุงูุจ_ุงูุดุฑุงุก', 0),
            market_data.get('ุนุฑุถ_ุงูุนูุงุฑุงุช', 1),
            1.0
        )
        avg_sale_time = 100 - market_data.get('ูุคุดุฑ_ุงูุณูููุฉ', 0)
        
        report = f"""
๐ **ุชูุฑูุฑ ุงููุณูุท ุงูุนูุงุฑู ุงููุญุชุฑู - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ุชุญููู ุณูู ุงููุณุงุทุฉ ูู {user_city}:**

๐ **ูุคุดุฑุงุช ุฃุฏุงุก ุงูุณูู:**
โข ุญุฌู ุงูุชุฏุงูู ุงูุดูุฑู: {safe_num(market_data.get('ุญุฌู_ุงูุชุฏุงูู_ุดูุฑู', 0))} ุตููุฉ
โข ูุชูุณุท ููุช ุงูุจูุน: {safe_num(avg_sale_time, '.0f')} ููู
โข ูุณุจุฉ ุงูุนุฑุถ ููุทูุจ: 1 : {safe_num(demand_supply_ratio, '.1f')}
โข ูุนุฏู ุงูุฅุดุบุงู: {safe_num(market_data.get('ูุนุฏู_ุงูุฅุดุบุงู', 0), '.0f')}%

๐ฏ **ุงุณุชุฑุงุชูุฌูุงุช ุฒูุงุฏุฉ ุงูุตููุงุช:**

1. **๐ ุชุญุณูู ูุงุฆูุฉ ุงูุนูุงุฑุงุช:**
   - ุงูุชุฑููุฒ ุนูู ุงูููุงุทู ุฐุงุช ุณุฑุนุฉ ุงูุจูุน ุงูุนุงููุฉ
   - ุชุญุณูู ุฌูุฏุฉ ุงูุตูุฑ ูุงููุตู ููุนูุงุฑุงุช
   - ุงุณุชุฎุฏุงู ุงูุชุณุนูุฑ ุงูุชูุงูุณู ุงูุฐูู

2. **๐ค ุจูุงุก ุงูุนูุงูุงุช:**
   - ุชุทููุฑ ุดุจูุฉ ูุณุชุซูุฑูู ูุญูููู ูู {user_city}
   - ุงูุชุนุงูู ูุน ุงููุทูุฑูู ุงูุนูุงุฑููู
   - ุจูุงุก ุณูุนุฉ ููููุฉ ูููุฉ

3. **๐ฐ ุชุญุณูู ุงูุฅูุฑุงุฏุงุช:**
   - ุฒูุงุฏุฉ ูุชูุณุท ูููุฉ ุงูุตููุฉ
   - ุชูููู ููุช ุงูุจูุน
   - ุชุญุณูู ุนูููุงุช ุงูุตููุงุช

๐ก **ูุตุงุฆุญ ุงูุฎุจุฑุงุก ูููุณุทุงุก:**
"ุงููุณูุท ุงููุงุฌุญ ูู {user_city} ููุณ ูุฌุฑุฏ ุจุงุฆุนุ ุจู ูุณุชุดุงุฑ ููุซูู. 
ุจูุงุก ุงูุซูุฉ ูุน ุงูุนููุงุก ูู ุงุณุชุซูุงุฑ ุทููู ุงูุฃุฌู ูุถูู ุงุณุชูุฑุงุฑูุฉ ุงูุตููุงุช."

๐ **ูุชุญุณูู ุฃุฏุงุฆู:**
ุงุณุชูุฏ ูู ุฃุฏูุงุชูุง ุงููุชูุฏูุฉ ูููุณุงุทุฉ ุงูุนูุงุฑูุฉ ูุชุฏุฑูุจุงุชูุง ุงูุงุญุชุฑุงููุฉ.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุงููุณูุท")
    
    def _developer_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐๏ธ ุชูุฑูุฑ ุดุฑูุฉ ุงูุชุทููุฑ - ูุฑูุฒ ุนูู ุงููุดุงุฑูุน ูุงูุฌุฏูู"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        demand_gap = market_data.get('ุทุงูุจ_ุงูุดุฑุงุก', 0) - market_data.get('ุนุฑุถ_ุงูุนูุงุฑุงุช', 0)
        annual_growth = market_data.get('ูุนุฏู_ุงูููู_ุงูุดูุฑู', 0) * 12
        
        report = f"""
๐๏ธ **ุชูุฑูุฑ ุชุทููุฑ ุงููุดุงุฑูุน ุงูุนูุงุฑูุฉ - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ุชุญููู ูุฑุต ุงูุชุทููุฑ ูู {user_city}:**

๐ **ูุคุดุฑุงุช ุณูู ุงูุชุทููุฑ:**
โข ูุนุฏู ุงูููู ุงูุณูุงูู: {safe_num(annual_growth, '.1f')}% ุณูููุงู
โข ูุฌูุฉ ุงูุนุฑุถ ูุงูุทูุจ: {safe_num(demand_gap)} ูุญุฏุฉ
โข ูุชูุณุท ุณุนุฑ ุงูุจูุงุก: {safe_num(market_data.get('ูุชูุณุท_ุงูุณูู', 0) * 0.4, '.0f')} ุฑูุงู/ูยฒ
โข ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ: {safe_num(market_data.get('ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู', 0) + 5, '.1f')}%

๐ฏ **ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุทููุฑ ุงููุงุฌุญ:**

1. **๐ ุงุฎุชูุงุฑ ุงููููุน ุงูุงุณุชุฑุงุชูุฌู:**
   - ูุฑุจ ูู ุงููุดุงุฑูุน ุงูุชููููุฉ ุงููุจุฑู
   - ุชูุงูุฑ ุงูุจููุฉ ุงูุชุญุชูุฉ
   - ุณูููุฉ ุงููุตูู ูุงูููู

2. **๐ ุงูุชุตููู ูุงูุฌุฏูู:**
   - ุฏุฑุงุณุฉ ุงุญุชูุงุฌุงุช ุงูุณูู ุจุฏูุฉ
   - ุชุญููู ุงูููุงูุณูู ุงููุญูููู
   - ุญุณุงุจ ููุทุฉ ุงูุชุนุงุฏู ูุงูุฑุจุญูุฉ

3. **๐ฐ ุฅุฏุงุฑุฉ ุงููุดุฑูุน:**
   - ุชุญุณูู ุชูุงููู ุงูุจูุงุก
   - ุฅุฏุงุฑุฉ ุงูุฌุฏูู ุงูุฒููู
   - ุชุณููู ูุนุงู ุฎูุงู ุงูุจูุงุก

๐ก **ุฑุคูุฉ ุฎุจุฑุงุก ุงูุชุทููุฑ:**
"ุงููุดุงุฑูุน ุงููุงุฌุญุฉ ูู {user_city} ุชุจุฏุฃ ุจุฏุฑุงุณุฉ ุฌุฏูู ุฏูููุฉ ูุชูุชูู ุจุชุณููู ูุชุฌุงูุฒ ุชููุนุงุช ุงูุนููุงุก. 
ุงูุฌูุฏุฉ ูุงูููุช ูุงููููุฉ ูุซูุซ ุงููุฌุงุญ ูู ุงูุชุทููุฑ ุงูุนูุงุฑู."

๐ **ูุฏุฑุงุณุงุช ุงูุฌุฏูู ุงููุชุฎุตุตุฉ:**
ูููุฑ ุฏุฑุงุณุงุช ุฌุฏูู ููุตูุฉ ูุชุญูููุงุช ุณูู ูุชูุฏูุฉ ููุดุงุฑูุนู ุงููุณุชูุจููุฉ.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุงููุทูุฑ")
    
    def _individual_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐จโ๐ฉโ๐ง ุชูุฑูุฑ ุงููุฑุฏ - ูุฑูุฒ ุนูู ุงูุณูู ูุงูุชูููู"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        area = user_info.get('area', 120)
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        avg_property_price = market_data.get('ูุชูุณุท_ุงูุณูู', 0) * area
        min_price = market_data.get('ุฃูู_ุณุนุฑ', 0) * area
        max_price = market_data.get('ุฃุนูู_ุณุนุฑ', 0) * area
        
        report = f"""
๐ก **ุชูุฑูุฑ ุงูุจุญุซ ุนู ุงูุณูู ุงููุซุงูู - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ุชุญููู ุณูู ุงูุณูู ูู {user_city}:**

๐ **ูุคุดุฑุงุช ุงูุณูู ูููุดุชุฑู:**
โข ูุชูุณุท ุณุนุฑ ุงููุณูู: {safe_num(avg_property_price)} ุฑูุงู
โข ูุทุงู ุงูุฃุณุนุงุฑ: {safe_num(min_price)} - {safe_num(max_price)} ุฑูุงู
โข ุฎูุงุฑุงุช ุงูุชูููู ุงููุชุงุญุฉ: 5-8 ุฎูุงุฑุงุช ูุฎุชููุฉ
โข ูุชุฑุฉ ุงูุจุญุซ ุงููุชููุนุฉ: {safe_num(100 - market_data.get('ูุคุดุฑ_ุงูุณูููุฉ', 0), '.0f')} ููู

๐ฏ **ุฎุทุฉ ุงูุจุญุซ ุงูุฐูู:**

1. **๐ ุชุญุฏูุฏ ุงูููุงุทู ุงูููุงุณุจุฉ:**
   - ูุฑุจ ูู ููุงู ุงูุนูู/ุงูุฏุฑุงุณุฉ
   - ุชูุงูุฑ ุงูุฎุฏูุงุช ุงูุฃุณุงุณูุฉ
   - ุงูุจูุฆุฉ ุงููุฌุชูุนูุฉ ุงูููุงุณุจุฉ

2. **๐ฐ ุงูุชุฎุทูุท ุงููุงูู:**
   - ุญุณุงุจ ุงููุจูุบ ุงูููุฏู (20-30%)
   - ุงุฎุชูุงุฑ ุจุฑูุงูุฌ ุงูุชูููู ุงูุฃูุณุจ
   - ุชููุน ุงูุชูุงููู ุงูุชุดุบูููุฉ

3. **๐ ุชูููู ุงูุนูุงุฑ:**
   - ุงููุญุต ุงูููู ุงูุฏููู
   - ููุงุฑูุฉ ูุน ุนูุงุฑุงุช ูุดุงุจูุฉ
   - ุงูุชูุงูุถ ุนูู ุงูุณุนุฑ ูุงูุดุฑูุท

๐ก **ูุตุงุฆุญ ูุดุฑุงุก ุฃูู ููุฒู:**
"ูุง ุชุณุชุนุฌู ุงููุฑุงุฑ ูู {user_city}. ุฒูุฑ ุงูุนูุงุฑ ูู ุฃููุงุช ูุฎุชููุฉุ ุชุญุฏุซ ูุน ุงูุฌูุฑุงูุ 
ูุชุฃูุฏ ูู ููุงุกูุชู ูุงุญุชูุงุฌุงุชู ุงูุญุงููุฉ ูุงููุณุชูุจููุฉ."

๐ **ููุณุงุนุฏุชู ูู ุงูุจุญุซ:**
ูููุฑ ูู ูุงุฆูุฉ ุจุงูุนูุงุฑุงุช ุงูููุงุณุจุฉ ููุณุงุนุฏู ูู ุงูููุงูุถุงุช ูุงูุชูููู.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุงููุฑุฏ")
    
    def _opportunity_seeker_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐ ุชูุฑูุฑ ุงูุจุงุญุซ ุนู ูุฑุต - ูุฑูุฒ ุนูู ุงูุงูุชุดุงู ูุงูุงุณุชุซูุงุฑ"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        discounted_properties = market_data.get('ุนุฑุถ_ุงูุนูุงุฑุงุช', 0) * 0.15
        renovation_opportunities = market_data.get('ุนุฑุถ_ุงูุนูุงุฑุงุช', 0) * 0.25
        
        report = f"""
๐ **ุชูุฑูุฑ ุตุงุฆุฏ ุงููุฑุต ุงูุนูุงุฑูุฉ - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ุชุญููู ูุฑุต ุงูุณูู ูู {user_city}:**

๐ **ูุคุดุฑุงุช ุงููุฑุต ุงููุฎููุฉ:**
โข ุนูุงุฑุงุช ุจุฎุตู 10-20%: {safe_num(discounted_properties, '.0f')} ุนูุงุฑ
โข ููุงุทู ููู ุฌุฏูุฏุฉ: 3-5 ููุงุทู ูุฑุดุญุฉ
โข ูุฑุต ุงูุชุฌุฏูุฏ ูุงูุชุญุณูู: {safe_num(renovation_opportunities, '.0f')} ุนูุงุฑ
โข ุณุฑุนุฉ ุงูุชุดุงู ุงููุฑุต: 2-3 ุฃูุงู ูููุฑุต ุงูููุชุงุฒุฉ

๐ฏ **ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุดุงู ุงููุฑุต:**

1. **๐ ุงูุจุญุซ ุงููุชูุฏู:**
   - ูุฑุงูุจุฉ ุงูุณูู ููููุงู
   - ุงูุจุญุซ ุนู ุงูุจุงุฆุนูู ุงููุณุชุนุฌููู
   - ุงูุชุดุงู ุงูููุงุทู ูุจู ุงูุชุดุงุฑูุง

2. **๐ก ุชุญููู ุงููููุฉ ุงููุฎููุฉ:**
   - ุนูุงุฑุงุช ุจุญุงุฌุฉ ุฅูู ุชุญุณูู
   - ููุงุทู ุนูู ูุดู ุงูุชุทููุฑ
   - ูุฑุต ุงูุดุฑุงุก ุจุงูุฌููุฉ

3. **๐ ุงูุชูููุฐ ุงูุณุฑูุน:**
   - ุงุชุฎุงุฐ ุงููุฑุงุฑ ุฎูุงู 48 ุณุงุนุฉ
   - ุชูููู ูุณุจู ุงูุงุณุชุนุฏุงุฏ
   - ูุฑูู ุชูููุฐ ุณุฑูุน

๐ก **ููุณูุฉ ุตุงุฆุฏ ุงููุฑุต:**
"ุงููุฑุต ุงูุญููููุฉ ูู {user_city} ูุง ุชุนูู ุนู ููุณูุง. ุชุญุชุงุฌ ุฅูู ุนูู ูุฏุฑุจุฉุ 
ูุฃุฐู ุตุงุบูุฉุ ููุฏุฑุฉ ุนูู ุงูุชุญุฑู ุงูุณุฑูุน."

๐ **ููุงูุชุดุงู ุงููุจูุฑ ูููุฑุต:**
ุงุดุชุฑู ูู ูุธุงู ุงูุชูุจููุงุช ุงูููุฑูุฉ ูุฏููุง ูุงูุชุดุงู ุงููุฑุต ูุจู ุงูุฌููุน.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุตุงุฆุฏ ุงููุฑุต")
    
    def _owner_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐ก ุชูุฑูุฑ ูุงูู ุงูุนูุงุฑ - ูุฑูุฒ ุนูู ุงูุฅุฏุงุฑุฉ ูุงูุจูุน"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        avg_sale_time = 100 - market_data.get('ูุคุดุฑ_ุณูููุฉ', market_data.get('ูุคุดุฑ_ุงูุณูููุฉ', 85))
        maintenance_cost = market_data.get('ูุชูุณุท_ุงูุณูู', 6000) * 120 * 0.015  # 1.5% ูู ูููุฉ ุงูุนูุงุฑ
        
        report = f"""
๐ **ุชูุฑูุฑ ูุงูู ุงูุนูุงุฑ ุงูุฐูู - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ุชุญููู ุณูู ุงููุงูู ูู {user_city}:**

๐ **ูุคุดุฑุงุช ุงูุณูู ูููุงูููู:**
โข ูุชูุณุท ููุช ุงูุจูุน: {safe_num(avg_sale_time, '.0f')} ููู
โข ูุงูุด ุงูุชูุงูุถ: 5-15% ุญุณุจ ุงูููุทูุฉ
โข ูุนุฏู ุงูุฅูุฌุงุฑ: {safe_num(market_data.get('ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู', 0), '.1f')}% ุณูููุงู
โข ุชูููุฉ ุงูุตูุงูุฉ ุงูุณูููุฉ: ~{safe_num(maintenance_cost)} ุฑูุงู

๐ฏ **ุงุณุชุฑุงุชูุฌูุงุช ุชุนุธูู ุงููููุฉ:**

1. **๐ฐ ุชุญุณูู ุงููููุฉ ุงูุณูููุฉ:**
   - ุชุฌุฏูุฏ ุงููุงุฌูุงุช ูุงูุฏูููุฑ ุงูุฏุงุฎูู
   - ุชุญุณูู ููุงุกุฉ ุงูุทุงูุฉ
   - ุชุญุฏูุซ ุงููุฑุงูู ูุงูุฎุฏูุงุช

2. **โฐ ุงูุชูููุช ุงูุฃูุซู ููุจูุน:**
   - ุจูุน ุฎูุงู ููุงุณู ุงูุฐุฑูุฉ ูู {user_city}
   - ุงูุงุณุชูุงุฏุฉ ูู ุงููุดุงุฑูุน ุงูุชููููุฉ ุงููุฑูุจุฉ
   - ุชุฌูุจ ุงูููุงูุณุฉ ุงูุนุงููุฉ

3. **๐ ุฅุฏุงุฑุฉ ุงูุนูุงุฑ ุงููุคุฌุฑ:**
   - ุงุฎุชูุงุฑ ุงููุณุชุฃุฌุฑ ุงูููุงุณุจ
   - ุนููุฏ ุฅูุฌุงุฑ ูุชูุงุฒูุฉ
   - ุตูุงูุฉ ููุงุฆูุฉ ููุชุธูุฉ

๐ก **ูุตุงุฆุญ ููููุงู ุงูุฃุฐููุงุก:**
"ุงูุนูุงุฑ ูู {user_city} ููุณ ูุฌุฑุฏ ุฃุตูุ ุจู ูุดุฑูุน ุงุณุชุซูุงุฑู ูุญุชุงุฌ ุฅูู ุฅุฏุงุฑุฉ ุฐููุฉ. 
ุงูุชุญุณููุงุช ุงูุตุบูุฑุฉ ุชุฎูู ูุฑูุงู ูุจูุฑุงู ูู ุงููููุฉ ูุงูุฅูุฌุงุฑ."

๐ **ูุฅุฏุงุฑุฉ ูุชูุงููุฉ:**
ูููุฑ ุฎุฏูุงุช ุฅุฏุงุฑุฉ ุงูุนูุงุฑุงุช ูุงูุชูููู ุงูุฏูุฑู ูุชุญุณูู ุงููููุฉ ุงูุณูููุฉ.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุงููุงูู")
    
    def _general_report(self, user_info, market_data, real_data, chosen_pkg, user_city):
        """๐ ุชูุฑูุฑ ุนุงู - ูููุณุชุฎุฏููู ุงูุฌุฏุฏ ุฃู ุงููุฆุงุช ุบูุฑ ุงููุญุฏุฏุฉ"""
        package_info = self.package_features.get(chosen_pkg, self.package_features["ูุฌุงููุฉ"])
        
        # ุงุณุชุฎุฏุงู safe_div ููููู ุงูุฑูุงุถูุฉ
        demand_supply_ratio = safe_div(
            market_data.get('ุทุงูุจ_ุงูุดุฑุงุก', 0),
            market_data.get('ุนุฑุถ_ุงูุนูุงุฑุงุช', 1),
            1.0
        )
        
        report = f"""
๐ **ุงูุชูุฑูุฑ ุงูุนุงู ูุณูู ุงูุนูุงุฑุงุช - Warda Intelligence**

๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**

๐ **ุงููุฏููุฉ:** {user_city}
๐ฐ **ุงูุจุงูุฉ:** {chosen_pkg}
๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:** {package_info['pages']} ุตูุญุฉ ุชุญููููุฉ
๐ **ุนูู ุงูุชุญููู:** {package_info['analysis_depth']}
๐ **ุงูุชุงุฑูุฎ:** {datetime.now().strftime('%Y-%m-%d')}

๐ **ูุธุฑุฉ ุนุงูุฉ ุนูู ุณูู {user_city}:**

๐ **ูุคุดุฑุงุช ุงูุณูู ุงูุฑุฆูุณูุฉ:**
โข ูุชูุณุท ุงูุฃุณุนุงุฑ: {safe_num(market_data.get('ูุชูุณุท_ุงูุณูู', 0))} ุฑูุงู/ูยฒ
โข ุญุฑูุฉ ุงูุณูู: {safe_num(market_data.get('ุญุฌู_ุงูุชุฏุงูู_ุดูุฑู', 0))} ุตููุฉ/ุดูุฑ
โข ุงุชุฌุงู ุงูููู: {safe_num(market_data.get('ูุนุฏู_ุงูููู_ุงูุดูุฑู', 0), '.1f')}% ุดูุฑูุงู
โข ุณูููุฉ ุงูุณูู: {safe_num(market_data.get('ูุคุดุฑ_ุงูุณูููุฉ', 0), '.0f')}/100
โข ูุณุจุฉ ุงูุนุฑุถ ููุทูุจ: 1 : {safe_num(demand_supply_ratio, '.1f')}

๐ฏ **ุชูุตูุงุช ุนุงูุฉ:**

1. **๐ ูููุณุชุซูุฑูู ุงูุฌุฏุฏ:**
   - ุงุจุฏุฃ ุจุงูุนูุงุฑุงุช ุงูุตุบูุฑุฉ ูู {user_city}
   - ุชุนูู ูู ุงูุณูู ุงููุญูู ุฃููุงู
   - ุงุณุชุดุฑ ุงูุฎุจุฑุงุก ูุจู ุงูุงุณุชุซูุงุฑ ุงููุจูุฑ

2. **๐ ูููุดุชุฑูู:**
   - ุญุฏุฏ ููุฒุงููุชู ุจุฏูุฉ
   - ุงุจุญุซ ูู ููุงุทู ูุชุนุฏุฏุฉ ูู {user_city}
   - ูุง ุชุชุณุฑุน ูู ุงุชุฎุงุฐ ุงููุฑุงุฑ

3. **๐ฐ ููุจุงุฆุนูู:**
   - ุฌูุฒ ุนูุงุฑู ููุนุฑุถ
   - ุณุนุฑ ุชูุงูุณู ูุฌุฐุงุจ
   - ุงุณุชุฎุฏู ูุณุงุฆุท ุนุฑุถ ูุชุนุฏุฏุฉ

๐ก **ุฑุณุงูุฉ ูู Warda Intelligence:**
"ุณูู {user_city} ูููุก ุจุงููุฑุต ููู ูุนุฑู ููู ูุจุญุซ. ูุญู ููุง ููุณุงุนุฏู ูู ุงุชุฎุงุฐ ุงููุฑุงุฑ ุงูุตุญูุญ 
ุจูุงุกู ุนูู ุจูุงูุงุช ุฏูููุฉ ูุชุญููู ูุชุฎุตุต."

๐ **ููุญุตูู ุนูู ุชุญููู ูุฎุตุต:**
ุงุฎุชุฑ ูุฆุชู ูู ุงููุฑุฉ ุงููุงุฏูุฉ ููุญุตูู ุนูู ุชูุฑูุฑ ูุฎุตุต ูุงุญุชูุงุฌุงุชู.
        """
        
        # ุฅุถุงูุฉ ุงููุญุชูู ุงูููุณุน ููุจุงูุงุช ุงููููุฒุฉ
        return report + self._get_extended_content(user_info, market_data, real_data, chosen_pkg, "ุชูุฑูุฑ ุนุงู")
    
    def _get_extended_content(self, user_info, market_data, real_data, chosen_pkg, report_type):
        """ุฅุถุงูุฉ ูุญุชูู ููุณุน ููุจุงูุงุช ุงููููุฒุฉ"""
        user_city = self.city or user_info.get('city', 'ุงููุฏููุฉ ุงููุณุชูุฏูุฉ')
        
        if chosen_pkg in ["ุฐูุจูุฉ", "ูุงุณูุฉ", "ูุงุณูุฉ ูุชููุฒุฉ"]:
            return f"""

๐ **ุงููุญุชูู ุงูุชุญูููู ุงููุชูุฏู - {report_type}**

๐ **ููุญุตูู ุนูู ุชุญููู ูุงูู ุดุงูู:**
1. ุฏุฑุงุณุงุช ุงูุฌุฏูู ุงูุชูุตูููุฉ
2. ุชุญููู ุงูููุงูุณูู ุงููุชูุฏู
3. ููุงุฐุฌ ุงูุชูุจุค ุจุงูุฃุณุนุงุฑ
4. ุงุณุชุดุงุฑุงุช ูุชุฎุตุตุฉ ูุจุงุดุฑุฉ

๐ **ุจุงูุฉ {chosen_pkg} ุชูุฏู:**
โข {self.package_features.get(chosen_pkg, {}).get('pages', 60)} ุตูุญุฉ ุชุญููููุฉ
โข {self.package_features.get(chosen_pkg, {}).get('charts', 15)} ุฑุณู ุจูุงูู ุชูุงุนูู
โข ุชุญุฏูุซุงุช ุฏูุฑูุฉ ููุณูู
โข ุฏุนู ุงุณุชุดุงุฑู ูุชุฎุตุต

๐ฏ **ุงุณุชุซูุฑ ูู ูุนุฑูุชู ุงูููู ูุชุจูู ูุณุชูุจูู ุงูุบุฏ ูู {user_city}**
"""
        return ""

    # ุฏุงูุฉ ุงูุชูุงูู ูุน ุงูููุฏ ุงููุฏูู
    def generate_smart_report(self, user_info, market_data, real_data, chosen_pkg):
        """ุฏุงูุฉ ุงูุชูุงูู - ุชุณุชุฏุนู generate_extended_report"""
        return self.generate_extended_report(user_info, market_data, real_data, chosen_pkg)

# ุงุฎุชุจุงุฑ ุงููุธุงู ุงููุญุฏุซ
if __name__ == "__main__":
    print("๐งช ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุฐูู ููุชูุงุฑูุฑ - ุงููุณุฎุฉ ุงููุญุณูุฉ\n")
    
    # ุงุฎุชุจุงุฑ ุชูุงุฑูุฑ ูุฎุชููุฉ
    test_cases = [
        {"city": "ุงูุฑูุงุถ", "plan": "ุฐูุจูุฉ", "category": "investor", "user_type": "ูุณุชุซูุฑ"},
        {"city": "ุฌุฏุฉ", "plan": "ูุถูุฉ", "category": "broker", "user_type": "ูุณูุท ุนูุงุฑู"},
        {"city": "ุงูุฏูุงู", "plan": "ูุฌุงููุฉ", "category": "individual", "user_type": "ูุฑุฏ"},
        {"city": "ููุฉ ุงูููุฑูุฉ", "plan": "ูุงุณูุฉ", "category": "opportunity", "user_type": "ุจุงุญุซ ุนู ูุฑุตุฉ"},
        {"city": "ุงููุฏููุฉ ุงููููุฑุฉ", "plan": "ุฐูุจูุฉ", "category": "owner", "user_type": "ูุงูู ุนูุงุฑ"}
    ]
    
    for i, test_data in enumerate(test_cases):
        print(f"\n{'='*80}")
        print(f"ุงุฎุชุจุงุฑ #{i+1}: {test_data['user_type']} - {test_data['city']} - {test_data['plan']}")
        print('='*80)
        
        smart_system = SmartReportSystem(test_data)
        
        # ุจูุงูุงุช ุชุฌุฑูุจูุฉ
        sample_user_info = {"city": test_data['city'], "area": 120}
        sample_market_data = {
            'ูุชูุณุท_ุงูุณูู': 6000,
            'ุงูุนุงุฆุฏ_ุงูุชุฃุฌูุฑู': 7.5,
            'ูุนุฏู_ุงูููู_ุงูุดูุฑู': 2.5,
            'ูุคุดุฑ_ุงูุณูููุฉ': 85,
            'ุญุฌู_ุงูุชุฏุงูู_ุดูุฑู': 120,
            'ุทุงูุจ_ุงูุดุฑุงุก': 180,
            'ุนุฑุถ_ุงูุนูุงุฑุงุช': 100,
            'ูุนุฏู_ุงูุฅุดุบุงู': 90,
            'ุฃูู_ุณุนุฑ': 4200,
            'ุฃุนูู_ุณุนุฑ': 9000
        }
        
        try:
            report = smart_system.generate_extended_report(
                sample_user_info, 
                sample_market_data, 
                pd.DataFrame(), 
                test_data['plan']
            )
            
            # ุงูุชุญูู ูู ุงูุชุนุฏููุงุช ุงูุฌุฏูุฏุฉ
            contains_pages = "๐งพ **ุนุฏุฏ ุตูุญุงุช ุงูุชูุฑูุฑ:**" in report
            contains_personalized = "๐ **ูุฐุง ุงูุชูุฑูุฑ ูุฎุตุต ูู ุจูุงุกู ุนูู ูููู ุงูุงุณุชุซูุงุฑู**" in report
            contains_extended = "ุงููุญุชูู ุงูุชุญูููู ุงููุชูุฏู" in report
            
            print(f"๐ ููุน ุงูุชูุฑูุฑ: {test_data['user_type']}")
            print(f"๐๏ธ ุงููุฏููุฉ: {test_data['city']}")
            print(f"๐ฐ ุงูุจุงูุฉ: {test_data['plan']}")
            print(f"๐ฏ ุงููุฆุฉ: {test_data['category']}")
            print(f"๐ ุนุฏุฏ ุงูุตูุญุงุช ูุฐููุฑ: {'โ' if contains_pages else 'โ'}")
            print(f"๐ญ ุฑุณุงูุฉ ุชุฎุตูุต: {'โ' if contains_personalized else 'โ'}")
            print(f"๐ ูุญุชูู ููุณุน: {'โ' if contains_extended else 'โ'}")
            print(f"๐ ุทูู ุงูุชูุฑูุฑ: {len(report)} ุญุฑู")
            print(f"โ ุชู ุฅูุดุงุก ุชูุฑูุฑ {test_data['user_type']} ุจูุฌุงุญ!")
            
        except Exception as e:
            print(f"โ ุฎุทุฃ ูู ุฅูุดุงุก ุงูุชูุฑูุฑ: {e}")
    
    print(f"\n{'='*80}")
    print("๐ฏ ุงุฎุชุจุงุฑ ุญุงุฑุณ ุงูุฌูุฏุฉ:")
    
    # ุงุฎุชุจุงุฑ ูุน ุจูุงูุงุช ูุงุฑุบุฉ
    smart_system = SmartReportSystem({"city": "ุงูุฑูุงุถ", "plan": "ุฐูุจูุฉ", "category": "investor"})
    try:
        report = smart_system.generate_extended_report(
            {"city": "ุงูุฑูุงุถ", "area": 120},
            {},  # ุจูุงูุงุช ูุงุฑุบุฉ
            pd.DataFrame(),
            "ุฐูุจูุฉ"
        )
        print("โ ุชู ุชูููุฏ ุชูุฑูุฑ ุจูุฌุงุญ ูุน ุจูุงูุงุช ูุงุฑุบุฉ (ุงุณุชุฎุฏู ุงูุจูุงูุงุช ุงูุงุญุชูุงุทูุฉ)")
    except Exception as e:
        print(f"โ ุฎุทุฃ ูู ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงููุงุฑุบุฉ: {e}")
    
    print("โ ุฌููุน ุงูุชุนุฏููุงุช ุชู ุชุทุจูููุง ุจูุฌุงุญ!")
