# ultimate_report_system.py
# =========================================
# Ultimate Report Closure System
# Warda Intelligence â€“ Executive Usage Layer
# =========================================

from datetime import datetime


class UltimateReportSystem:
    """
    ÙˆØ§Ø¬Ù‡Ø© Ù…ÙˆØ­Ø¯Ø© ÙŠØ³ØªØ®Ø¯Ù…Ù‡Ø§ Streamlit
    Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
    """

    def __init__(self, final_decision=None):
        self.final_decision = final_decision

    def apply(self, report_text: str) -> str:
        """
        ÙŠØ¶ÙŠÙ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ + Ø§Ù„Ø®ØªÙ… Ø§Ù„Ø²Ù…Ù†ÙŠ
        """
        if not report_text:
            return report_text

        report_text = self._append_execution_closure(report_text)
        report_text = self._stamp_report(report_text)

        return report_text

    # =====================================
    # Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ (12 Ø´Ù‡Ø±)
    # =====================================
    def _build_execution_closure(self) -> str:
        if not self.final_decision:
            return ""

        return f"""
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ§­ ÙƒÙŠÙ ØªØ³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø±Ø§Ø± Ø®Ù„Ø§Ù„ Ø§Ù„Ù€ 12 Ø´Ù‡Ø± Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©ØŸ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø±Ø§Ø± Ù„ÙŠØ³ ØªÙˆØµÙŠØ© Ù„Ø­Ø¸Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ
Ø¨Ù„ Ø¥Ø·Ø§Ø± Ø¹Ù…Ù„ÙŠ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø³ÙˆÙ‚ Ø¨Ù‡Ø¯ÙˆØ¡ ÙˆØ«Ø¨Ø§Øª.

ðŸ“… Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ù„Ø£Ø´Ù‡Ø± (1 â€“ 3) | Ø§Ù„ØªØ«Ø¨ÙŠØª ÙˆØ§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
â€¢ Ø±Ø§Ù‚Ø¨ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø¯ÙˆÙ† Ø§Ø³ØªØ¹Ø¬Ø§Ù„
â€¢ Ù„Ø§ ØªØºÙŠÙ‘Ø± Ø§Ù„Ù‚Ø±Ø§Ø± Ø¨Ø³Ø¨Ø¨ Ø£Ø®Ø¨Ø§Ø± Ù‚ØµÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ù‰
â€¢ Ø±ÙƒÙ‘Ø² ÙÙ‚Ø· Ø¹Ù„Ù‰:
  â€“ Ø­Ø±ÙƒØ© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„ÙØ¹Ù„ÙŠ
  â€“ Ø§Ù„ÙØ¬ÙˆØ© Ø¨ÙŠÙ† Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„Ù…Ù†ÙØ°
  â€“ Ù…Ø¯Ø© Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚

Ø¥Ø°Ø§ Ø¨Ù‚ÙŠØª Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø¶Ù…Ù† Ù†Ø·Ø§Ù‚Ù‡Ø§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØŒ
ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„Ù‚Ø±Ø§Ø± ÙŠØ³ÙŠØ± ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ØªÙˆÙ‚Ø¹.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“… Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ù„Ø£Ø´Ù‡Ø± (4 â€“ 6) | Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù‡Ø§Ø¯Ø¦
â€¢ Ø£Ø¹Ø¯ Ù‚Ø±Ø§Ø¡Ø© Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
â€¢ Ø§Ø³Ø£Ù„ Ù†ÙØ³Ùƒ:
  â€“ Ù‡Ù„ ØªØºÙŠÙ‘Ø±Øª Ø§Ù„ÙØ±Ø¶ÙŠØ© Ø§Ù„ØªÙŠ Ø¨ÙÙ†ÙŠ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„Ù‚Ø±Ø§Ø±ØŸ
  â€“ Ø£Ù… ØªØºÙŠÙ‘Ø± Ø§Ù„Ø¶Ø¬ÙŠØ¬ ÙÙ‚Ø·ØŸ

Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø£ÙŠ ØªØ­Ø±Ùƒ
Ø¥Ù„Ø§ Ø¥Ø°Ø§ ØªØ­Ù‚Ù‚Øª Ø¥Ø­Ø¯Ù‰ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø£Ø¹Ù„Ø§Ù‡.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“… Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©: Ø§Ù„Ø£Ø´Ù‡Ø± (7 â€“ 9) | ØªÙˆØ³ÙŠØ¹ Ø§Ù„Ø±Ø¤ÙŠØ©
â€¢ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ØªØ¨Ø¯Ø£ Ø§Ù„Ø¥Ø´Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø¨Ø§Ù„ÙˆØ¶ÙˆØ­
â€¢ Ø¥Ù† ÙƒØ§Ù† Ø§Ù„Ù‚Ø±Ø§Ø±:
  â€“ Ù…Ø±ÙŠØ­Ù‹Ø§ Ù†ÙØ³ÙŠÙ‹Ø§
  â€“ ÙˆÙ…Ø³ØªÙ‚Ø±Ù‹Ø§ Ø±Ù‚Ù…ÙŠÙ‹Ø§
  â€“ ÙˆÙ„Ù… ØªØ¸Ù‡Ø± Ø¥Ø´Ø§Ø±Ø§Øª Ø¥Ù†Ø°Ø§Ø±

ÙØ§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù‡Ù†Ø§ ÙŠÙØ¹Ø¯ Ù‚ÙˆØ©ØŒ Ù„Ø§ ØªØ±Ø¯Ø¯Ù‹Ø§.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“… Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©: Ø§Ù„Ø£Ø´Ù‡Ø± (10 â€“ 12) | Ù‚Ø±Ø§Ø± Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
â€¢ Ø±Ø§Ø¬Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø± Ù…Ø±Ø© Ø£Ø®ÙŠØ±Ø© Ø®Ù„Ø§Ù„ Ø§Ù„Ø³Ù†Ø©
â€¢ Ù„Ø§ ØªØ¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙƒÙ…Ø§Ù„
â€¢ Ø§Ø³Ø£Ù„ ÙÙ‚Ø·:
  "Ù‡Ù„ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø±Ø§Ø± Ù…Ø§ Ø²Ø§Ù„ ÙŠØ®Ø¯Ù…Ù†ÙŠ Ø¯ÙˆÙ† Ø¶ØºØ·ØŸ"

Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ù†Ø¹Ù… â†’ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù…Ù†Ø·Ù‚ÙŠ  
Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù„Ø§ â†’ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ù‡Ù†Ø§ Ù†Ø¶Ø¬ØŒ Ù„Ø§ ÙØ´Ù„

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ§  Ù…ØªÙ‰ ØªØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø¶Ø¬ÙŠØ¬ ØªÙ…Ø§Ù…Ù‹Ø§ØŸ
â€¢ Ø¹Ù†Ø¯ Ø§Ù„Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ø§Ù…Ø© ØºÙŠØ± Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¨Ø¨ÙŠØ§Ù†Ø§Øª
â€¢ Ø¹Ù†Ø¯ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ø§Ù„Ø³Ø·Ø­ÙŠØ© Ù…Ø¹ ØµÙÙ‚Ø§Øª ÙØ±Ø¯ÙŠØ©
â€¢ Ø¹Ù†Ø¯ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø£ØµÙˆØ§Øª Ø¯ÙˆÙ† ØªØºÙŠÙ‘Ø± Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª

Ø§Ù„Ø¶Ø¬ÙŠØ¬ Ù…Ø±ØªÙØ¹ Ø¯Ø§Ø¦Ù…Ù‹Ø§â€¦
Ù„ÙƒÙ† Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø¬ÙŠØ¯Ø© ØªÙØ¨Ù†Ù‰ ÙÙŠ Ø§Ù„ØµÙ…Øª.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ¤ Ù…ØªÙ‰ ØªØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ØŸ
â€¢ Ø¥Ø°Ø§ ØªØ­Ù‚Ù‚Øª Ø¥Ø­Ø¯Ù‰ Ø¥Ø´Ø§Ø±Ø§Øª ØªØºÙŠÙŠØ± Ø§Ù„Ù‚Ø±Ø§Ø±
â€¢ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø¹Ø¯ 3â€“6 Ø£Ø´Ù‡Ø±
â€¢ Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª ØªØ¶Ø§Ø±Ø¨Ù‹Ø§ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØ§Ù„ÙˆØ§Ù‚Ø¹
â€¢ Ø£Ùˆ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø±Ø£ÙŠÙ‹Ø§ Ø«Ø§Ù†ÙŠÙ‹Ø§ Ù‚Ø¨Ù„ Ø£ÙŠ Ø®Ø·ÙˆØ© ÙƒØ¨ÙŠØ±Ø©

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Œ Ù…Ù„Ø§Ø­Ø¸Ø© Ø®ØªØ§Ù…ÙŠØ©
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø±Ø§Ø± ØµÙÙ…Ù… Ù„ÙŠÙƒÙˆÙ†:
â€¢ ÙˆØ§Ø¶Ø­Ù‹Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ù‡Ø¯ÙˆØ¡
â€¢ Ù…ØªÙ…Ø§Ø³ÙƒÙ‹Ø§ Ø¹Ù†Ø¯ Ø§Ù„ØªØ°Ø¨Ø°Ø¨
â€¢ ÙˆØºÙŠØ± Ù…ÙØ¯Ù…Ù‘Ø± Ø­ØªÙ‰ Ø¥Ù† Ø£Ø®Ø·Ø£

Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± Ø§Ù„Ø°ÙƒÙŠ Ù„Ø§ ÙŠØµÙ†Ø¹ Ø¶Ø¬ÙŠØ¬Ù‹Ø§â€¦
Ù„ÙƒÙ†Ù‡ ÙŠØµÙ†Ø¹ Ø±Ø§Ø­Ø©ØŒ ÙˆØ§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©ØŒ ÙˆÙ‚Ø±Ø§Ø±Ø§Øª ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹ÙŠØ´ Ù…Ø¹Ù‡Ø§.
"""

    def _append_execution_closure(self, report_text: str) -> str:
        closure = self._build_execution_closure()
        if not closure:
            return report_text
        return report_text + "\n\n" + closure

    def _stamp_report(self, report_text: str) -> str:
        return (
            report_text
            + f"\n\nâ€”\nØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ØªØ§Ø±ÙŠØ®: {datetime.now().strftime('%Y-%m-%d')}"
        )
